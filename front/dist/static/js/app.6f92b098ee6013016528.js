webpackJsonp([1],{"E+DV":function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("7+uW"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]},o=i("VU/8")({name:"App"},s,!1,null,null,null).exports,n=i("/ocq"),r=i("mtWM"),l=i.n(r).a.create({baseURL:"api/",auth:{username:"offeruser",password:'D_f$7u-SVX9v"h;j'}}),d={name:"KeywordsToRemove",props:["keywords","regions","rivals","offerid","maxRivalsCount","sqiDiffCoef","maxPos","minCountInSerm"],data:function(){return{data:{},errors:[],isLoaded:!1,isLoading:!1,minKeywordRivals:5,filename:""}},methods:{fetchKeywordsToRemove:function(){var t=this;this.errors=[],this.isLoading=!0,l.post("GetKeywordsToRemove/",{keywords:this.keywords,regions:this.regions,minKeywordRivals:this.minKeywordRivals}).then(function(e){t.data=e.data,"string"==typeof e.data&&(t.data=JSON.parse(e.data)),t.errors=[],t.isLoaded=!0,t.isLoading=!1}).catch(function(e){t.errors=[],t.errors.push(e),t.isLoaded=!0,t.isLoading=!1})},exportToExcel:function(){var t=this;this.filename="",l.post("ExportToExcel/",{keywords:this.keywords,regions:this.regions,rivals:this.rivals,offerid:this.offerid,maxRivalsCount:this.maxRivalsCount,sqiDiffCoef:this.sqiDiffCoef,maxPos:this.maxPos,minCountInSerm:this.minCountInSerm,minKeywordRivals:this.minKeywordRivals,keywordsToDelete:this.data}).then(function(e){t.filename=e.data}).catch(function(t){alert(t)})}}},v={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h2",[t._v("Запросы для удаления")]),t._v(" "),i("div",{staticClass:"large-12 cell"},[i("label",[t._v("Минимальное количество конкурентов")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.minKeywordRivals,expression:"minKeywordRivals"}],attrs:{type:"text",autocomplete:"on"},domProps:{value:t.minKeywordRivals},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.fetchKeywordsToRemove(e)},input:function(e){e.target.composing||(t.minKeywordRivals=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"large-12 cell"},[i("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:t.fetchKeywordsToRemove}},[t._v("Получить запросы с количеством конкурентов меньше "+t._s(t.minKeywordRivals)+" ")])]),t._v(" "),t.isLoading||t.isLoaded?i("div",{staticClass:"keywordsToRemove"},[t._l(t.errors,function(e){return t.isLoaded&&t.errors.length>0?i("div",{key:e,staticClass:"error-text"},[i("p",[t._v("Ошибка получения данных с сервера:")]),t._v(" "),i("p",[t._v(t._s(e))])]):t._e()}),t._v(" "),t.isLoading?i("p",[t._v("Загрузка..."),i("br"),t._v("Получение данных может занять несколько минут.")]):t._e(),t._v(" "),t.isLoaded&&!t.isLoading?i("div",[t._l(t.data,function(e){return i("div",{key:e.region,staticClass:"large-12 cell"},[i("label",[t._v(t._s(e.region))]),t._v(" "),i("textarea",{attrs:{rows:"10"},domProps:{value:e.keywordsToDelete.join("\n")}})])}),t._v(" "),0===t.data.length?i("p",[t._v("Нет запросов для удаления.")]):t._e(),t._v(" "),i("div",{staticClass:"large-12 cell"},[i("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:t.exportToExcel}},[t._v("Выгрузить в .xlsx")])]),t._v(" "),t.filename.length>0?i("iframe",{staticStyle:{display:"none"},attrs:{src:"download/"+t.filename}}):t._e()],2):t._e()],2):t._e()])},staticRenderFns:[]};var c={name:"SermModal",props:["keyword","regionName","searchEngine","rivalsCount","regionId","seName","isMobile","maxPos","startDate","rivals","regions","notRivals"],data:function(){return{data:[],errors:[],isLoaded:!1,isLoading:!1}},mounted:function(){var t=this;this.errors=[],this.isLoading=!0,l.post("GetSerm/",{keyword:this.keyword,regionId:this.regionId,searchEngine:this.searchEngine,isMobile:this.isMobile,maxPos:this.maxPos,startDate:this.startDate,rivals:this.rivals,regions:this.regions,notRivals:this.notRivals}).then(function(e){t.data=e.data,t.errors=[],t.isLoaded=!0,t.isLoading=!1}).catch(function(e){t.errors=[],t.errors.push(e),t.isLoaded=!0,t.isLoading=!1})},methods:{getIsRivalText:function(t){return t?"Нет":"Да"},hideModal:function(){this.$emit("hidemodal")},getTableClass:function(t){return{"dark-background":t}}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"reveal-overlay",staticStyle:{display:"block"}},[i("div",{staticClass:"reveal large",staticStyle:{display:"block"}},[i("h1",[t._v("Выдача по запросу")]),t._v(" "),i("p",[t._v("Запрос: "+t._s(t.keyword))]),t._v(" "),i("p",[t._v("Регион: "+t._s(t.regionName))]),t._v(" "),i("p",[t._v("ПС: "+t._s(t.seName))]),t._v(" "),i("p",[t._v("Кол-во конкурентов: "+t._s(t.rivalsCount))]),t._v(" "),t.isLoading?i("p",[t._v("Загрузка..."),i("br"),t._v("Получение данных может занять несколько минут.")]):t._e(),t._v(" "),t.isLoaded&&!t.isLoading?i("div",[0===t.data.length?i("p",[t._v("Не найдено ни одного результата выдачи.")]):t._e(),t._v(" "),t.data.length>0?i("table",{staticClass:"unstriped"},[t._m(0),t._v(" "),i("tbody",t._l(t.data,function(e){return i("tr",{key:e.position+e.domain,class:t.getTableClass(e.isExcluded)},[i("td",[t._v(t._s(e.position))]),t._v(" "),i("td",[i("a",{attrs:{href:"http://"+e.domain,target:"_blank"}},[t._v(t._s(e.domain))])]),t._v(" "),i("td",[i("a",{attrs:{href:e.foundUrl,target:"_blank"}},[t._v(t._s(e.foundUrl))])]),t._v(" "),i("td",[t._v(t._s(t.getIsRivalText(e.isExcluded)))])])}))]):t._e()]):t._e(),t._v(" "),i("button",{staticClass:"close-button",attrs:{type:"button"},on:{click:t.hideModal}},[i("span",[t._v("×")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("th",[this._v("Позиция")]),this._v(" "),e("th",[this._v("Домен")]),this._v(" "),e("th",[this._v("Страница в выдаче")]),this._v(" "),e("th",[this._v("Конкурент")])])}]};var m={name:"Keywords",components:{keywordsToRemove:i("VU/8")(d,v,!1,function(t){i("mQ+E")},null,null).exports,sermModal:i("VU/8")(c,u,!1,function(t){i("tlis")},null,null).exports},props:["keywords","rivals","maxPos","startDate","keywordsStr","regionsStr","regions","minCountInSerm","offerid","sqiDiffCoef","minKeywordRivals","maxRivalsCount"],data:function(){return{data:{},notRivals:[],errors:[],isLoaded:!1,isLoading:!1,isModalShown:!1,modalData:{isModalShown:!1}}},computed:{exportData:function(){var t={};return t.maxPos=this.maxPos,t.minCountInSerm=this.minCountInSerm,t.keywords=this.data,t.regions=this.regions,t.rivals=this.rivals,t.offerid=this.offerid,t.sqiDiffCoef=this.sqiDiffCoef,t.minKeywordRivals=this.minKeywordRivals,t.maxRivalsCount=this.maxRivalsCount,t}},methods:{fetchKeywords:function(){var t=this;this.errors=[],this.isLoading=!0,l.post("GetKeywordsRivals/",{keywords:this.keywords,rivals:this.rivals,maxPos:this.maxPos,startDate:this.startDate,keywordsStr:this.keywordsStr,regionsStr:this.regionsStr,regions:this.regions,minCountInSerm:this.minCountInSerm}).then(function(e){t.data=e.data.keywords,t.notRivals=e.data.notRivals,t.errors=[],t.isLoaded=!0,t.isLoading=!1}).catch(function(e){t.errors=[],t.errors.push(e),t.isLoaded=!0,t.isLoading=!1})},getSearchEngineName:function(t){return 1===t?"Яндекс":2===t?"Google":"—"},showModal:function(t){this.modalData=t,this.modalData.maxPos=this.maxPos,this.modalData.startDate=this.startDate,this.modalData.rivals=this.rivals,this.modalData.seName=this.getSearchEngineName(t.searchEngine),this.modalData.regions=this.regions,this.modalData.notRivals=this.notRivals,this.modalData.isModalShown=!0},hideModal:function(){this.modalData={isModalShown:!1}}}},_={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h2",[t._v("Запросы")]),t._v(" "),i("div",{staticClass:"large-12 cell"},[i("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:t.fetchKeywords}},[t._v("Получить данные по запросам")])]),t._v(" "),t.isLoading||t.isLoaded?i("div",{staticClass:"keywords"},[t._l(t.errors,function(e){return t.isLoaded&&t.errors.length>0?i("div",{key:e,staticClass:"error-text"},[i("p",[t._v("Ошибка получения данных с сервера:")]),t._v(" "),i("p",[t._v(t._s(e))])]):t._e()}),t._v(" "),t.isLoading?i("p",[t._v("Загрузка..."),i("br"),t._v("Получение данных может занять несколько минут.")]):t._e(),t._v(" "),t.isLoaded&&!t.isLoading?i("div",[i("table",{staticClass:"unstriped"},[i("thead",[i("tr",[i("th",[t._v("Ключевое слово")]),t._v(" "),i("th",[t._v("Регион")]),t._v(" "),i("th",[t._v("ПС")]),t._v(" "),i("th",{staticClass:"text-right"},[t._v("Кол-во конкурентов в топ "+t._s(t.maxPos))])])]),t._v(" "),i("tbody",t._l(t.data,function(e){return i("tr",{key:e.id+e.regionName+e.searchEngine},[i("td",[i("a",{on:{click:function(i){t.showModal(e)}}},[t._v(t._s(e.keyword))])]),t._v(" "),i("td",[t._v(t._s(e.regionName))]),t._v(" "),i("td",[t._v(t._s(t.getSearchEngineName(e.searchEngine)))]),t._v(" "),i("td",{staticClass:"text-right"},[t._v(t._s(e.rivalsCount))])])}))])]):t._e(),t._v(" "),t.modalData.isModalShown?i("sermModal",t._b({on:{hidemodal:t.hideModal}},"sermModal",t.modalData,!1)):t._e(),t._v(" "),t.isLoaded&&!t.isLoading?i("keywordsToRemove",t._b({},"keywordsToRemove",t.exportData,!1)):t._e()],2):t._e()])},staticRenderFns:[]};var h={name:"Rivals",components:{keywords:i("VU/8")(m,_,!1,function(t){i("dTGe")},null,null).exports},data:function(){return{data:{},errors:[],isValid:!0,isLoaded:!1,isLoading:!1,offerUrl:"http://client.ingate.ru/Offers/offer/5d0cc9587e76801f38a88cd0/keywords",maxRivalsCount:1e5,sqiDiffCoef:100,maxPos:10,minCountInSerm:6}},computed:{rivalsData:function(){var t=this.data;return t.maxPos=this.maxPos,t.minCountInSerm=this.minCountInSerm,t.sqiDiffCoef=this.sqiDiffCoef,t.minKeywordRivals=this.minKeywordRivals,t.maxRivalsCount=this.maxRivalsCount,t}},methods:{validateAndFetch:function(){var t=this;this.errors=[],this.offerUrl.length>0?(this.isValid=!0,this.isLoading=!0,l.post("GetRivals/",{offerUrl:this.offerUrl,maxRivalsCount:this.maxRivalsCount,sqiDiffCoef:this.sqiDiffCoef,maxPos:this.maxPos,minCountInSerm:this.minCountInSerm}).then(function(e){for(var i in t.data=e.data,t.errors=[],t.isLoaded=!0,t.isLoading=!1,t.data.rivals){var a=t.data.rivals[i].domain;t.data.rivals[i].isOfferDomain||l.post("GetDomainInfo/",{domain:a}).then(function(e){var a=e.data,s=a.domain,o=t.data.rivals;for(i in o){var n=o[i];n.domain===s&&(n.title=a.title,n.description=a.description,n.icon=a.icon,t.$set(t.data.rivals,i,n))}})}}).catch(function(e){t.errors=[],t.errors.push(e),t.isLoaded=!0,t.isLoading=!1})):(this.isValid=!1,this.isLoading=!1)},makeValid:function(){this.isValid=!0},setOfferUrl:function(t){this.offerUrl=t},toggleAllisExcluded:function(t){var e=t.target.checked;for(var i in this.data.rivals){var a=this.data.rivals[i];a.isExcluded=e,this.$set(this.data.rivals,i,a)}}}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"main grid-container"},[i("h1",[t._v("Фильтрация запросов по количеству конкурентов")]),t._v(" "),i("form",{staticClass:"rivals-form"},[i("div",{staticClass:"large-12 cell"},[i("label",[t._v("\n              Ссылка на КП\n              "),i("br"),t._v(" "),i("small",[t._v("Например, "),i("a",{on:{click:function(e){t.setOfferUrl("http://client.ingate.ru/Offers/offer/5cdd6e3d7e76803de48abc1a/keywords")}}},[t._v("\n                  http://client.ingate.ru/Offers/offer/5cdd6e3d7e76803de48abc1a/keywords\n              ")])])]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.offerUrl,expression:"offerUrl"}],attrs:{type:"text",autofocus:"autofocus",autocomplete:"on"},domProps:{value:t.offerUrl},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.validateAndFetch(e)},input:function(e){e.target.composing||(t.offerUrl=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"large-12 cell"},[i("label",[t._v("Не считать конкурентом, если встречается в выдаче реже этого числа раз")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.minCountInSerm,expression:"minCountInSerm"}],attrs:{type:"text",autocomplete:"on"},domProps:{value:t.minCountInSerm},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.validateAndFetch(e)},input:function(e){e.target.composing||(t.minCountInSerm=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"large-12 cell"},[i("label",[t._v("Максимальное количество конкурентов")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.maxRivalsCount,expression:"maxRivalsCount"}],attrs:{type:"text",autocomplete:"on"},domProps:{value:t.maxRivalsCount},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.validateAndFetch(e)},input:function(e){e.target.composing||(t.maxRivalsCount=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"large-12 cell"},[i("label",[t._v("Максимальное отклонение Яндекс ИКС конкурентов (количество раз)")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.sqiDiffCoef,expression:"sqiDiffCoef"}],attrs:{type:"text",autocomplete:"on"},domProps:{value:t.sqiDiffCoef},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.validateAndFetch(e)},input:function(e){e.target.composing||(t.sqiDiffCoef=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"large-12 cell"},[i("label",[t._v("Максимальная позиция для поиска конкурентов")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.maxPos,expression:"maxPos"}],attrs:{type:"text",autocomplete:"on"},domProps:{value:t.maxPos},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.validateAndFetch(e)},input:function(e){e.target.composing||(t.maxPos=e.target.value)}}})]),t._v(" "),t.isValid?t._e():i("div",{staticClass:"alert-box alert"},[t._v("\n        Укажи ссылку на КП.\n        "),i("a",{staticClass:"close",attrs:{href:"#"},on:{click:t.makeValid}},[t._v("×")])]),t._v(" "),i("div",{staticClass:"large-12 cell"},[i("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:t.validateAndFetch}},[t._v("Получить данные по конкурентам")])])]),t._v(" "),t.isLoading||t.isLoaded?i("div",{staticClass:"rivals"},[i("h2",[t._v("Конкуренты")]),t._v(" "),t._l(t.errors,function(e){return t.isLoaded&&t.errors.length>0?i("div",{key:e,staticClass:"error-text"},[i("p",[t._v("Ошибка получения данных с сервера:")]),t._v(" "),i("p",[t._v(t._s(e))])]):t._e()}),t._v(" "),t.isLoading?i("p",[t._v("Загрузка..."),i("br"),t._v("Получение данных может занять несколько минут.")]):t._e(),t._v(" "),t.isLoaded&&!t.isLoading?i("div",[t._l(t.data.rivals,function(e){return i("div",{key:e.domain},[e.isOfferDomain?i("div",[i("p",[t._v("Домен КП: "),i("a",{attrs:{href:"http://"+e.domain,target:"_blank"}},[t._v(t._s(e.domain))])]),t._v(" "),i("p",[t._v("Встречается в топ "+t._s(t.maxPos)+": "+t._s(e.countInSerm))]),t._v(" "),i("p",[t._v("Яндекс ИКС: "+t._s(e.sqi[0]))]),t._v(" "),i("p",[t._v("Данные только по десктопной выдаче.")])]):t._e()])}),t._v(" "),i("table",{staticClass:"unstriped"},[i("thead",[i("tr",[i("th",[t._v("Сайт")]),t._v(" "),i("th",{staticClass:"text-right"},[t._v("Не конкурент "),i("input",{attrs:{type:"checkbox",id:"toggle-all"},on:{input:t.toggleAllisExcluded}})]),t._v(" "),i("th",{staticClass:"text-right"},[t._v("Встречается в топ "+t._s(t.maxPos))]),t._v(" "),i("th",{staticClass:"text-right"},[t._v("Яндекс ИКС")]),t._v(" "),i("th",{staticClass:"text-right"},[t._v("Отклонение ИКС от сайта КП")])])]),t._v(" "),i("tbody",t._l(t.data.rivals,function(e){return e.isOfferDomain?t._e():i("tr",{key:e.title+e.domain},[i("td",[i("a",{attrs:{href:"http://"+e.domain,target:"_blank"}},[i("img",{attrs:{width:"16",height:"16",src:e.icon}}),t._v(" "+t._s(e.domain))]),t._v(" "),i("br"),t._v("\n                      "+t._s(e.title)+"\n                      "),i("br"),t._v(" "),i("small",[t._v(t._s(e.description))])]),t._v(" "),i("td",{staticClass:"text-right"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.isExcluded,expression:"rival.isExcluded"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isExcluded)?t._i(e.isExcluded,null)>-1:e.isExcluded},on:{change:function(i){var a=e.isExcluded,s=i.target,o=!!s.checked;if(Array.isArray(a)){var n=t._i(a,null);s.checked?n<0&&(e.isExcluded=a.concat([null])):n>-1&&(e.isExcluded=a.slice(0,n).concat(a.slice(n+1)))}else t.$set(e,"isExcluded",o)}}})]),t._v(" "),i("td",{staticClass:"text-right"},[t._v(t._s(e.countInSerm))]),t._v(" "),i("td",{staticClass:"text-right"},[t._v(t._s(e.sqi[0]))]),t._v(" "),i("td",{staticClass:"text-right"},[t._v(t._s(e.sqiDiff.toFixed(2)))])])}))])],2):t._e()],2):t._e(),t._v(" "),t.isLoaded&&!t.isLoading?i("keywords",t._b({},"keywords",t.rivalsData,!1)):t._e()],1)},staticRenderFns:[]};var p=i("VU/8")(h,f,!1,function(t){i("E+DV")},null,null).exports;a.a.use(n.a);var g=new n.a({routes:[{path:"/",name:"Rivals",component:p}]});a.a.config.productionTip=!1,new a.a({el:"#app",router:g,components:{App:o},template:"<App/>"})},dTGe:function(t,e){},"mQ+E":function(t,e){},tlis:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.6f92b098ee6013016528.js.map