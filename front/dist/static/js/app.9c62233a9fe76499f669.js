webpackJsonp([1],{"/6eh":function(e,t){},"356v":function(e,t){},"3hCC":function(e,t){},"4BPl":function(e,t){},"7W36":function(e,t){},AeFz:function(e,t){},FZO8:function(e,t){},IPdH:function(e,t){},LbxH:function(e,t){},MHY7:function(e,t){},Mrzp:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("7+uW"),i=s("eFvv"),a=s.n(i),o={name:"App",components:{VueElementLoading:a.a},watch:{$route:function(e,t){document.title=e.meta.title}},computed:{isStateLoading:function(){return this.$store.state.isStateLoading}},created:function(){this.$store.dispatch("getState")}},r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("vue-element-loading",{attrs:{active:this.isStateLoading,"is-full-screen":!0,color:"#1C457D"}}),this._v(" "),t("router-view")],1)},staticRenderFns:[]},l=s("VU/8")(o,r,!1,null,null,null).exports,c=s("/ocq"),u=s("fZjL"),d=s.n(u),m=s("mtWM"),v=s.n(m),p={name:"Menu",props:["selectedElement"],data:function(){return{adminSubmenuShown:!1,reportsSubmenuShown:!1,isOverAdmin:!1,isOverReports:!1,isOverNoSubmenuEl:!1,isOverMenu:!1}},methods:{openMenu:function(e){var t=this;"admin"===e&&(this.isOverAdmin=!0,setTimeout(function(){t.isOverAdmin&&!t.isOverNoSubmenuEl&&t.isOverMenu&&(t.adminSubmenuShown=!0,t.reportsSubmenuShown=!1)},100)),"reports"===e&&(this.isOverReports=!0,setTimeout(function(){t.isOverReports&&!t.isOverNoSubmenuEl&&t.isOverMenu&&(t.adminSubmenuShown=!1,t.reportsSubmenuShown=!0)},100))},closeMenus:function(e){(this.isOverNoSubmenuEl||!this.isOverMenu||e)&&(this.reportsSubmenuShown=!1,this.adminSubmenuShown=!1)},leaveMenu:function(){this.isOverMenu=!1,setTimeout(this.closeMenus,300)},enterNoSubmenuEl:function(){this.isOverNoSubmenuEl=!0,setTimeout(this.closeMenus,300)},logout:function(){v.a.post("/logout").then(function(e){window.location.href="/login"})}},computed:{navClass:function(){var e="main-menu";return(this.adminSubmenuShown||this.reportsSubmenuShown)&&(e+=" submenu-shown"),e},adminClass:function(){var e="with-submenu";return"admin"===this.selectedElement&&(e+=" selected"),this.adminSubmenuShown&&(e+=" hovered"),e},reportsClass:function(){var e="with-submenu";return"reports"===this.selectedElement&&(e+=" selected"),this.reportsSubmenuShown&&(e+=" hovered"),e}}},_={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("nav",{class:e.navClass,on:{"&mouseleave":function(t){e.leaveMenu()},"&mouseover":function(t){e.isOverMenu=!0}}},[s("ul",{staticClass:"cell auto",class:e.adminSubmenuShown?"submenu shown":"submenu hidden"},[s("li",{staticClass:"close-item",on:{click:function(t){e.closeMenus(!0)}}},[s("button",{staticClass:"close-button",attrs:{type:"button"}},[e._v("×")])]),e._v(" "),s("li",[s("router-link",{attrs:{to:"/UploadExpenses"}},[e._v("Внести расходы")])],1),e._v(" "),s("li",[s("router-link",{attrs:{to:"/Offices"}},[e._v("Отделения")])],1),e._v(" "),s("li",[s("router-link",{attrs:{to:"/ServiceTypes"}},[e._v("Услуги")])],1),e._v(" "),s("li",[s("router-link",{attrs:{to:"/GoodsTypes"}},[e._v("Товары")])],1),e._v(" "),s("li",[s("router-link",{attrs:{to:"/ExpenseTypes"}},[e._v("Типы расходов")])],1),e._v(" "),s("li",[s("router-link",{attrs:{to:"/EmployeePaymentTypes"}},[e._v("Типы выплат сотрудникам")])],1),e._v(" "),s("li",[s("router-link",{attrs:{to:"/Employees"}},[e._v("Сотрудники")])],1),e._v(" "),s("li",[s("router-link",{attrs:{to:"/MasterTypes"}},[e._v("Категории мастеров")])],1)]),e._v(" "),s("ul",{class:e.reportsSubmenuShown?"submenu shown":"submenu hidden"},[s("li",{staticClass:"close-item",on:{click:function(t){e.closeMenus(!0)}}},[s("button",{staticClass:"close-button",attrs:{type:"button"}},[e._v("×")])]),e._v(" "),s("li",[s("router-link",{attrs:{to:"/EmployeesReport"}},[e._v("Отчёт по сотрудникам")])],1),e._v(" "),s("li",[s("router-link",{attrs:{to:"/ClientsReport"}},[e._v("Отчёт по клиентам")])],1),e._v(" "),s("li",[s("router-link",{attrs:{to:"/FinancialReport"}},[e._v("Финансовый отчёт")])],1)]),e._v(" "),s("ul",[s("li",{class:"session"===e.selectedElement?"selected":"",on:{"&mouseenter":function(t){e.enterNoSubmenuEl()},"&mouseleave":function(t){e.isOverNoSubmenuEl=!1}}},[s("router-link",{attrs:{to:"/"}},[s("svg",{staticClass:"main-menu-icon",attrs:{viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M20 40C31.0457 40 40 31.0457 40 20C40 8.9543 31.0457 0 20 0C8.9543 0 0 8.9543 0 20C0 31.0457 8.9543 40 20 40ZM20 36.5217C29.1247 36.5217 36.5217 29.1247 36.5217 20C36.5217 10.8753 29.1247 3.47826 20 3.47826C10.8753 3.47826 3.47826 10.8753 3.47826 20C3.47826 29.1247 10.8753 36.5217 20 36.5217Z",fill:"session"===e.selectedElement?"#FDFCFC":"#38342E"}}),e._v(" "),s("path",{attrs:{d:"M22.8986 20C22.8986 21.6008 21.6008 22.8986 20 22.8986C18.3992 22.8986 17.1014 21.6008 17.1014 20C17.1014 18.3992 18.3992 17.1014 20 17.1014C21.6008 17.1014 22.8986 18.3992 22.8986 20Z",fill:"session"===e.selectedElement?"#FDFCFC":"#38342E"}}),e._v(" "),s("path",{attrs:{d:"M20.8387 18.226C21.5283 18.8945 21.5455 19.9955 20.877 20.6852C20.2085 21.3749 19.1075 21.3921 18.4178 20.7236L13.4227 15.8819C12.733 15.2134 12.7158 14.1124 13.3843 13.4227C14.0528 12.733 15.1539 12.7158 15.8435 13.3843L20.8387 18.226Z",fill:"session"===e.selectedElement?"#FDFCFC":"#38342E"}}),e._v(" "),s("path",{attrs:{d:"M30.0853 12.4165C30.6349 12.088 31.3468 12.2673 31.6753 12.8169C32.0038 13.3666 31.8245 14.0784 31.2749 14.4069L20.8252 20.6525C20.2755 20.981 19.5636 20.8017 19.2351 20.2521C18.9066 19.7025 19.0859 18.9906 19.6355 18.6621L30.0853 12.4165Z",fill:"session"===e.selectedElement?"#FDFCFC":"#38342E"}})]),e._v(" "),s("label",[e._v("Смена")])])],1),e._v(" "),s("li",{class:"clients"===e.selectedElement?"selected":"",on:{"&mouseenter":function(t){e.enterNoSubmenuEl()},"&mouseleave":function(t){e.isOverNoSubmenuEl=!1}}},[s("router-link",{attrs:{to:"/Clients"}},[s("svg",{staticClass:"main-menu-icon",attrs:{viewBox:"0 0 34 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M16.6527 19.9163C22.1525 19.9163 26.6109 15.4579 26.6109 9.95816C26.6109 4.45842 22.1525 0 16.6527 0C11.153 0 6.69456 4.45842 6.69456 9.95816C6.69456 15.4579 11.153 19.9163 16.6527 19.9163ZM16.6527 16.9038C20.4887 16.9038 23.5983 13.7941 23.5983 9.95816C23.5983 6.12221 20.4887 3.01255 16.6527 3.01255C12.8168 3.01255 9.70711 6.12221 9.70711 9.95816C9.70711 13.7941 12.8168 16.9038 16.6527 16.9038Z",fill:"clients"===e.selectedElement?"#FDFCFC":"#38342E"}}),e._v(" "),s("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.48354 22.4455C3.95261 23.9909 3.01255 26.1093 3.01255 28.4519C3.01255 33.1659 6.83405 36.9874 11.5481 36.9874H21.9247C26.6387 36.9874 30.4602 33.1659 30.4602 28.4519C30.4602 26.069 29.4874 23.9175 27.9092 22.3657C27.8771 22.3775 27.8405 22.3926 27.7999 22.412C27.6784 22.47 27.5482 22.5532 27.4258 22.657C24.5233 25.1214 20.7581 26.6109 16.6527 26.6109C12.5906 26.6109 8.86116 25.1526 5.97115 22.7342C5.84761 22.6308 5.7161 22.5482 5.59338 22.4909C5.5526 22.4719 5.51585 22.457 5.48354 22.4455ZM3.61116 20.0635C4.80923 18.9296 6.63933 19.3652 7.90445 20.4239C10.2726 22.4055 13.3233 23.5983 16.6527 23.5983C20.0174 23.5983 23.0975 22.3801 25.4761 20.3606C26.7281 19.2975 28.5447 18.8476 29.7521 19.9612C32.0398 22.0713 33.4728 25.0942 33.4728 28.4519C33.4728 34.8297 28.3025 40 21.9247 40H11.5481C5.17027 40 0 34.8297 0 28.4519C0 25.1481 1.38732 22.1684 3.61116 20.0635Z",fill:"clients"===e.selectedElement?"#FDFCFC":"#38342E"}})]),e._v(" "),s("label",[e._v("Клиенты")])])],1),e._v(" "),s("li",{class:"history"===e.selectedElement?"selected":"",on:{"&mouseenter":function(t){e.enterNoSubmenuEl()},"&mouseleave":function(t){e.isOverNoSubmenuEl=!1}}},[s("router-link",{attrs:{to:"/SessionsHistory"}},[s("svg",{staticClass:"main-menu-icon",attrs:{viewBox:"0 0 40 38",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{d:"M21.2034 33.7265C29.4489 33.7265 36.1333 27.0422 36.1333 18.7966C36.1333 10.5511 29.4489 3.86675 21.2034 3.86675C12.9578 3.86675 6.27348 10.5511 6.27348 18.7966C6.27348 19.7609 6.36488 20.7038 6.53951 21.6171C4.39123 21.6171 2.47413 20.0852 2.47329 17.9369C2.47205 14.7476 3.34525 11.7897 5.17282 8.86298C7.68288 4.84332 11.6154 1.917 16.1866 0.66717C20.7578 -0.582655 25.6321 -0.0642086 29.8382 2.11919C34.0442 4.3026 37.2731 7.99063 38.8815 12.4483C40.4899 16.9061 40.3596 21.8061 38.5166 26.1721C36.6736 30.538 33.2533 34.0493 28.9371 36.0061C24.621 37.9629 19.726 38.2216 15.2277 36.7306C15.2277 36.7306 13.6015 36.0441 14.1091 34.5212C14.6168 32.9982 21.2034 33.7265 21.2034 33.7265Z",fill:"history"===e.selectedElement?"#FDFCFC":"#38342E"}}),e._v(" "),s("path",{attrs:{d:"M6.09435 16.0347C6.52977 15.2054 7.55502 14.8862 8.38429 15.3216C9.21357 15.757 9.53285 16.7823 9.09743 17.6115L6.29421 22.9503C5.85878 23.7796 4.83354 24.0989 4.00426 23.6635C3.17499 23.228 2.85571 22.2028 3.29113 21.3735L6.09435 16.0347Z",fill:"history"===e.selectedElement?"#FDFCFC":"#38342E"}}),e._v(" "),s("path",{attrs:{d:"M0.217815 17.7556C-0.241102 16.9391 0.0487836 15.9051 0.865294 15.4462C1.6818 14.9873 2.71574 15.2772 3.17466 16.0937L6.12913 21.3503C6.58804 22.1668 6.29816 23.2008 5.48165 23.6597C4.66514 24.1186 3.6312 23.8287 3.17228 23.0122L0.217815 17.7556Z",fill:"history"===e.selectedElement?"#FDFCFC":"#38342E"}})]),e._v(" "),s("label",[e._v("История")])])],1),e._v(" "),s("li",{class:e.reportsClass,on:{"&mouseenter":function(t){e.openMenu("reports")},"&mouseleave":function(t){e.isOverReports=!1}}},[s("svg",{staticClass:"main-menu-icon",attrs:{viewBox:"0 0 30 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{d:"M7.584 11.5C7.584 10.6716 8.25557 10 9.084 10H20.9723C21.8008 10 22.4723 10.6716 22.4723 11.5C22.4723 12.3284 21.8008 13 20.9723 13H9.084C8.25557 13 7.584 12.3284 7.584 11.5Z",fill:"reports"===e.selectedElement?"#FDFCFC":"#38342E"}}),e._v(" "),s("path",{attrs:{d:"M9.084 16C8.25557 16 7.584 16.6716 7.584 17.5C7.584 18.3284 8.25557 19 9.084 19H20.9723C21.8008 19 22.4723 18.3284 22.4723 17.5C22.4723 16.6716 21.8008 16 20.9723 16H9.084Z",fill:"reports"===e.selectedElement?"#FDFCFC":"#38342E"}}),e._v(" "),s("path",{attrs:{d:"M7.584 23.5C7.584 22.6716 8.25557 22 9.084 22H20.9723C21.8008 22 22.4723 22.6716 22.4723 23.5C22.4723 24.3284 21.8008 25 20.9723 25H9.084C8.25557 25 7.584 24.3284 7.584 23.5Z",fill:"reports"===e.selectedElement?"#FDFCFC":"#38342E"}}),e._v(" "),s("path",{attrs:{d:"M9.084 28C8.25557 28 7.584 28.6716 7.584 29.5C7.584 30.3284 8.25557 31 9.084 31H20.9723C21.8008 31 22.4723 30.3284 22.4723 29.5C22.4723 28.6716 21.8008 28 20.9723 28H9.084Z",fill:"reports"===e.selectedElement?"#FDFCFC":"#38342E"}}),e._v(" "),s("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.95533 0C2.66629 0 0 2.75517 0 6.15385V33.8462C0 37.2448 2.66629 40 5.95533 40H23.8213C27.1104 40 30 37.9554 30 34.5567V6C30 2.60132 27.1104 0 23.8213 0H5.95533ZM23.7097 3H5.56452C4.33113 3 2.90323 4.7255 2.90323 6V34.5567C2.90323 35.8312 4.08919 37 5.32258 37H23.7097C24.9431 37 27.0968 35.7745 27.0968 34.5V6C27.0968 4.7255 24.9431 3 23.7097 3Z",fill:"reports"===e.selectedElement?"#FDFCFC":"#38342E"}})]),e._v(" "),s("label",[e._v("Отчёты")])]),e._v(" "),s("li",{class:e.adminClass,on:{"&mouseenter":function(t){e.openMenu("admin")},"&mouseleave":function(t){e.isOverAdmin=!1}}},[s("svg",{staticClass:"main-menu-icon",attrs:{viewBox:"0 0 39 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.8605 0.000916544C15.8252 -4.58791e-05 15.7899 -0.000250263 15.7546 0.000303043C15.7028 -0.000509942 15.6509 0.000312842 15.599 0.0027714C15.5226 0.00639501 15.4466 0.0153202 15.3715 0.0294827C14.9113 0.116205 14.4865 0.331734 14.1452 0.649237C13.808 0.962833 13.566 1.36303 13.4433 1.80377L12.2876 5.81626C11.6168 6.15169 10.9829 6.53386 10.382 6.95065L6.39835 5.94375C5.87186 5.80563 5.31501 5.8455 4.81378 6.05663C4.30859 6.26942 3.89051 6.64312 3.62141 7.11632C3.62102 7.117 3.62063 7.11769 3.62025 7.11837L0.322345 12.9012C0.319141 12.9069 0.31597 12.9125 0.312832 12.9182C0.0539981 13.3847 -0.0478188 13.9216 0.0208605 14.4493C0.089535 14.977 0.325533 15.4709 0.697179 15.8562L3.52658 18.7822C3.48641 19.1623 3.45669 19.5711 3.45669 20.0005C3.45669 20.4298 3.48641 20.8386 3.52658 21.2186L0.697121 24.1448C0.325547 24.53 0.0895705 25.0239 0.0208941 25.5515C-0.0477771 26.0792 0.0539731 26.616 0.312774 27.0826C0.315931 27.0883 0.319121 27.0939 0.322345 27.0996L3.62017 32.8823C3.62045 32.8828 3.62074 32.8833 3.62102 32.8838C3.89006 33.3573 4.30823 33.7313 4.81364 33.9442C5.31509 34.1555 5.87199 34.1952 6.39831 34.0571L10.382 33.0502C10.9829 33.467 11.6168 33.8492 12.2876 34.1846L13.4467 38.2089C13.5963 38.725 13.9094 39.1809 14.3419 39.5054C14.7725 39.8283 15.2974 40.0028 15.8377 40H22.4255C22.9659 40.0028 23.4907 39.8283 23.9213 39.5054C24.3539 39.1809 24.6669 38.725 24.8165 38.2089L25.9756 34.1846C26.6465 33.8492 27.2803 33.467 27.8812 33.0502L31.8649 34.0572C32.3913 34.1952 32.9481 34.1555 33.4496 33.9442C33.9551 33.7312 34.3734 33.3571 34.6424 32.8835C34.6426 32.8831 34.6428 32.8827 34.6431 32.8823L37.9409 27.0996C37.9441 27.0939 37.9473 27.0883 37.9505 27.0826C38.2093 26.616 38.311 26.0792 38.2423 25.5515C38.1737 25.0239 37.9377 24.53 37.5661 24.1448L34.7367 21.2186C34.7768 20.8386 34.8065 20.4298 34.8065 20.0005C34.8065 19.5711 34.7768 19.1623 34.7366 18.7822L37.566 15.8562C37.9377 15.4709 38.1737 14.977 38.2424 14.4493C38.3111 13.9215 38.2092 13.3847 37.9504 12.9182C37.9473 12.9125 37.9441 12.9069 37.9409 12.9012L34.643 7.11837C34.6428 7.11801 34.6426 7.11766 34.6424 7.11731C34.3733 6.64367 33.955 6.26958 33.4495 6.05663C32.9482 5.8455 32.3914 5.80563 31.8649 5.94374L27.8813 6.95065C27.2803 6.53386 26.6464 6.15169 25.9756 5.81626L24.8165 1.79192C24.6669 1.27594 24.3539 0.820015 23.9212 0.495482C23.4909 0.172663 22.9661 -0.00192348 22.4258 0.000916544H15.8605ZM16.4483 3.30367H21.8149L23.0098 7.45221C23.1466 7.92701 23.4888 8.31563 23.9424 8.51138C24.859 8.90686 25.7162 9.42972 26.5329 10.0536C26.9334 10.3595 27.4516 10.4659 27.9401 10.3424L32.0824 9.29538L34.7659 14.0008L31.8134 17.0542C31.4617 17.4178 31.2962 17.9225 31.3641 18.4237C31.4436 19.0111 31.5038 19.4979 31.5038 20.0005C31.5038 20.503 31.4436 20.9897 31.3641 21.577C31.2962 22.0783 31.4617 22.583 31.8133 22.9466L34.7658 26.0001L32.0824 30.7055L27.9401 29.6585C27.4516 29.535 26.9334 29.6413 26.533 29.9472C25.7162 30.5711 24.8589 31.0941 23.9425 31.4895C23.4888 31.6852 23.1466 32.0739 23.0098 32.5487L21.8149 36.6972H16.4483L15.2534 32.5487C15.1166 32.0739 14.7744 31.6852 14.3207 31.4895C13.4043 31.0941 12.5471 30.5711 11.7302 29.9472C11.3298 29.6413 10.8116 29.535 10.3231 29.6585L6.18083 30.7055L3.49738 26.0001L6.44989 22.9466C6.8015 22.583 6.96706 22.0783 6.89916 21.577C6.8196 20.9897 6.75944 20.503 6.75944 20.0005C6.75944 19.4979 6.81961 19.0111 6.89916 18.4238C6.96706 17.9225 6.80149 17.4178 6.44988 17.0542L3.49737 14.0008L6.1808 9.29538L10.3231 10.3424C10.8117 10.4659 11.3299 10.3595 11.7303 10.0536C12.547 9.42972 13.4043 8.90686 14.3208 8.51138C14.7745 8.31563 15.1167 7.92701 15.2534 7.45221L16.4483 3.30367Z",fill:"admin"===e.selectedElement?"#FDFCFC":"#38342E"}}),e._v(" "),s("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19.0826 23.3027C20.9066 23.3027 22.3853 21.8241 22.3853 20C22.3853 18.1759 20.9066 16.6972 19.0826 16.6972C17.2585 16.6972 15.7798 18.1759 15.7798 20C15.7798 21.8241 17.2585 23.3027 19.0826 23.3027ZM19.0826 26.6055C22.7307 26.6055 25.6881 23.6481 25.6881 20C25.6881 16.3519 22.7307 13.3945 19.0826 13.3945C15.4345 13.3945 12.4771 16.3519 12.4771 20C12.4771 23.6481 15.4345 26.6055 19.0826 26.6055Z",fill:"admin"===e.selectedElement?"#FDFCFC":"#38342E"}})]),e._v(" "),s("label",[e._v("Админка")])]),e._v(" "),s("li",{staticClass:"with-submenu logout show-for-large",on:{click:e.logout}},[s("svg",{staticClass:"main-menu-icon",attrs:{viewBox:"0 0 35 41",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M27.6499 15.5398C28.3715 14.8104 29.5415 14.8104 30.2631 15.5398L33.9588 19.2751C34.6804 20.0045 34.6804 21.1871 33.9588 21.9164L30.2631 25.6518C29.5415 26.3812 28.3715 26.3812 27.6499 25.6518C26.9283 24.9224 26.9283 23.7399 27.6499 23.0105L30.039 20.5958L27.6499 18.1811C26.9283 17.4517 26.9283 16.2691 27.6499 15.5398Z",fill:"#38342E"}}),e._v(" "),s("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.6522 20.5958C15.6522 19.5643 16.4795 18.7281 17.5 18.7281H30.8043C31.8249 18.7281 32.6522 19.5643 32.6522 20.5958C32.6522 21.6273 31.8249 22.4635 30.8043 22.4635H17.5C16.4795 22.4635 15.6522 21.6273 15.6522 20.5958Z",fill:"#38342E"}}),e._v(" "),s("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.9754 6.42773C7.36164 8.79587 4.19565 12.5554 4.19565 20.9693C4.19565 29.3907 7.26591 32.6137 10.7289 34.5583C14.3807 36.6088 18.8998 36.6552 22.1003 36.2958C23.1146 36.1818 24.0282 36.9206 24.1409 37.9458C24.2536 38.971 23.5227 39.8944 22.5084 40.0083C19.0567 40.3959 13.5976 40.4422 8.93414 37.8236C4.08191 35.0989 0.5 30.4777 0.5 20.9693C0.5 11.4536 4.17097 6.43501 8.96486 3.29348C13.6327 0.234532 19.1159 -0.17273 22.6255 0.453269C23.6305 0.632528 24.3014 1.60131 24.1241 2.61711C23.9467 3.6329 22.9882 4.31105 21.9832 4.13179C19.2102 3.63718 14.7151 3.977 10.9754 6.42773Z",fill:"#38342E"}})]),e._v(" "),s("label",[e._v("Выйти")])])])])},staticRenderFns:[]};var f=s("VU/8")(p,_,!1,function(e){s("ecyf")},null,null).exports,y=v.a.create({baseURL:"/api/"});y.interceptors.response.use(function(e){return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),e});var g=s("T1ft"),h=s.n(g),b={name:"EmployeeCard",components:{VueElementLoading:a.a,"v-select":h.a},props:["employee"],created:function(){this.selectedEmployeePayment=this.employeePaymentTypes[0].id,this.paymentSum=this.employeePaymentTypes[0].defaultSum},data:function(){return{selectedEmployeePayment:null,paymentSum:0,servicesSearch:"",goodsSearch:"",isSaving:!1,savingError:""}},methods:{updateSum:function(){var e=this;this.paymentSum=this.employeePaymentTypes.filter(function(t){return t.id===e.selectedEmployeePayment})[0].defaultSum},save:function(){var e=this;this.isSaving=!0,this.savingError="";var t={type:"employeepayment",id:null,employeePaymentTypeId:this.selectedEmployeePayment,sessionId:this.currentSession.id,officeId:this.currentSession.officeId,datetime:this.moment().utc(),employeeId:this.employee.id,sum:this.paymentSum,comment:""};y.post("EditOperations/",[t]).then(function(t){e.$store.dispatch("getCurrentSession"),e.isSaving=!1}).catch(function(t){e.savingError=t,e.isSaving=!1})}},computed:{currentSession:{get:function(){return this.$store.state.currentSession}},services:{get:function(){return this.$store.state.serviceTypes}},goods:{get:function(){return this.$store.state.goodsTypes}},employeePaymentTypes:{get:function(){return this.$store.state.employeePaymentTypes}},filteredServices:function(){var e=this;return this.services.filter(function(t){return t.name.toLowerCase().includes(e.servicesSearch.toLowerCase())})},filteredGoods:function(){var e=this;return this.goods.filter(function(t){return t.name.toLowerCase().includes(e.goodsSearch.toLowerCase())})},adminId:function(){return this.$store.state.currentSession.employees.filter(function(e){return"officeAdmin"===e.role})[0].id}}},C={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"cell large-6 columns card employee-card"},[s("div",{staticClass:"employee-card-header grid-x grid-padding-x align-middle"},[s("div",{staticClass:"cell auto"},[s("h5",[e._v(e._s(e.employee.name))])]),e._v(" "),s("div",{staticClass:"cell auto show-for-medium"},[e._v("\n      Длина смены "),s("strong",[e._v(e._s(e.employee.workHours))]),e._v(" ч.\n    ")])]),e._v(" "),s("div",{staticClass:"employee-card-content grid-x grid-padding-x grid-padding-y"},["master"===e.employee.role?s("div",{staticClass:"cell small-6"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.servicesSearch,expression:"servicesSearch"}],attrs:{type:"text",placeholder:"Поиск по услугам"},domProps:{value:e.servicesSearch},on:{input:function(t){t.target.composing||(e.servicesSearch=t.target.value)}}}),e._v(" "),s("ul",{staticClass:"services-goods-list"},e._l(e.filteredServices,function(t){return s("li",{key:t.id},[s("router-link",{attrs:{to:{path:"/EditService/",query:{serviceTypeId:t.id,masterId:e.employee.id,adminId:e.adminId}}}},[e._v(e._s(t.name))])],1)}))]):e._e(),e._v(" "),s("div",{staticClass:"cell small-6"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.goodsSearch,expression:"goodsSearch"}],attrs:{type:"text",placeholder:"Поиск по товарам"},domProps:{value:e.goodsSearch},on:{input:function(t){t.target.composing||(e.goodsSearch=t.target.value)}}}),e._v(" "),s("ul",{staticClass:"services-goods-list"},e._l(e.filteredGoods,function(t){return s("li",{key:t.id},[s("router-link",{attrs:{to:{path:"/EditGoodsSell/",query:{goodTypeId:t.id,employeeId:e.employee.id===e.adminId?null:e.employee.id,adminId:e.adminId}}}},[e._v(e._s(t.name))])],1)}))])]),e._v(" "),s("div",{staticClass:"employee-card-footer grid-x grid-padding-x grid-padding-y"},[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("label",{staticClass:"cell small-12 no-padding-top-bottom"},[e._v("Выплата сотруднику")]),e._v(" "),s("div",{staticClass:"cell medium-6"},[s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.selectedEmployeePayment,label:"name",options:e.employeePaymentTypes},on:{input:e.updateSum},model:{value:e.selectedEmployeePayment,callback:function(t){e.selectedEmployeePayment=t},expression:"selectedEmployeePayment"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell auto"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.paymentSum,expression:"paymentSum"}],attrs:{type:"number",placeholder:"Сумма"},domProps:{value:e.paymentSum},on:{input:function(t){t.target.composing||(e.paymentSum=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"cell shrink"},[s("button",{staticClass:"button secondary",on:{click:e.save}},[e._v("Сохранить")])]),e._v(" "),e.savingError?s("div",{staticClass:"cell small-12 callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],1)])},staticRenderFns:[]};var E={name:"Session",components:{appMenu:f,employeeCard:s("VU/8")(b,C,!1,function(e){s("ayN0")},null,null).exports,VueElementLoading:a.a,"v-select":h.a},created:function(){var e=this;document.title=this.$route.meta.title,setInterval(function(){e.time=e.getTime(),e.date=e.getDate()},1e3),this.$store.state.refreshCurrentSession=setInterval(function(){e.getCurrentSession()},3e4),this.spendTypes.length&&(this.selectedSpendType=this.spendTypes[0].id,this.spendSum=this.getSpendSum(this.spendTypes[0].id))},beforeRouteLeave:function(e,t,s){this.$store.state.refreshCurrentSession&&clearInterval(this.$store.state.refreshCurrentSession),s()},data:function(){return{selectedSpendType:null,spendSum:0,isExpenseSaving:!1,expenseSavingError:"",time:this.getTime(),date:this.getDate()}},methods:{saveExpense:function(){var e=this;this.expenseSavingError="",this.isExpenseSaving=!0;var t={type:"spendoperation",id:null,expenseTypeId:this.selectedSpendType,sessionId:this.session.id,officeId:this.session.officeId,datetime:this.moment().utc(),sum:this.spendSum,comment:""};y.post("EditOperations/",[t]).then(function(t){e.$store.dispatch("getCurrentSession"),e.updateSpendSum(),e.isExpenseSaving=!1}).catch(function(t){e.expenseSavingError=t,e.isExpenseSaving=!1})},updateSpendSum:function(){this.spendSum=this.getSpendSum(this.selectedSpendType)},getSpendSum:function(e){return parseInt(this.spendTypes.filter(function(t){return t.id===e})[0].defaultSum)},getGreeting:function(){var e=(new Date).getHours();return e<=12?"Доброе утро!":e>12&&e<17?"Добрый день!":e>=17?"Добрый вечер!":void 0},getGreetingEmojis:function(){for(var e=["✂️","😀","💪","👋","😎","👏","🦄","🌄","🌅","❤️","🍒","🌈","😄","✌️","😉","🙂","✂️"],t=0,s="";t<3;){var n=Math.ceil(Math.random()*e.length-1);n<0&&(n=0),n>e.length&&(n=e.length-1),s+=e[n],t++}return s},getTime:function(){return this.moment().format("HH : mm")},getDate:function(){return this.moment().format("DD.MM.YY")},getCurrentSession:function(){this.$store.dispatch("getCurrentSession")},changeOffice:function(){this.$store.commit("updateStore",{name:"currentOfficeId",value:null}),this.$store.commit("updateStore",{name:"currentSession",value:{}}),this.$store.state.refreshCurrentSession&&clearInterval(this.$store.state.refreshCurrentSession)}},computed:{session:{get:function(){return this.$store.state.currentSession}},currentOfficeId:{get:function(){return this.$store.state.currentOfficeId},set:function(e){this.$store.commit("updateStore",{name:"currentOfficeId",value:e})}},isCurrentSessionLoading:{get:function(){return this.$store.state.isCurrentSessionLoading}},spendTypes:{get:function(){return this.$store.state.spendTypes}},offices:{get:function(){return this.$store.state.offices}},servicesCount:function(){return d()(this.session).length&&this.session.operations?this.session.operations.filter(function(e){return"serviceoperation"===e.type}).length:0},goodsCount:function(){return d()(this.session).length&&this.session.operations?this.session.operations.filter(function(e){return"goodsoperation"===e.type}).length:0},revenue:function(){if(d()(this.session).length&&this.session.operations){var e=0,t=this.session.operations.filter(function(e){return"serviceoperation"===e.type}),s=this.session.operations.filter(function(e){return"goodsoperation"===e.type});return t.map(function(t){e+=t.cashSum+t.cashlessSum-t.discountSum}),s.map(function(t){e+=t.cashSum+t.cashlessSum-t.discountSum}),e}return 0},costs:function(){if(d()(this.session).length&&this.session.operations){var e=0,t=this.session.operations.filter(function(e){return"spendoperation"===e.type}),s=this.session.operations.filter(function(e){return"employeepayment"===e.type});return t.map(function(t){e+=t.sum}),s.map(function(t){e+=t.sum}),e}return 0},bonus:function(){var e=this;if(d()(this.session).length&&this.session.operations){var t=0,s=this.session.operations.filter(function(e){return"serviceoperation"===e.type}),n=this.session.operations.filter(function(e){return"goodsoperation"===e.type});return s.map(function(s){t+=e.$store.getters.getOperationBonus(s)}),n.map(function(s){t+=e.$store.getters.getOperationBonus(s)}),t}return 0}}},S={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",{staticClass:"background"},[s("appMenu",{attrs:{"selected-element":"session"}}),e._v(" "),Object.keys(e.session).length?e._e():s("div",{staticClass:"grid-x align-center-middle content"},[s("div",{staticClass:"card cell shrink text-center greeting-card"},[s("h1",[e._v(e._s(e.getGreeting())),s("br"),e._v(e._s(e.getGreetingEmojis()))]),e._v(" "),s("label",[e._v("Отделение")]),e._v(" "),s("v-select",{attrs:{disabled:e.isCurrentSessionLoading,clearable:!1,reduce:function(e){return e.id},value:e.currentOfficeId,label:"name",options:e.offices},on:{input:e.getCurrentSession},model:{value:e.currentOfficeId,callback:function(t){e.currentOfficeId=t},expression:"currentOfficeId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("div",{staticClass:"position-relative"},[s("vue-element-loading",{attrs:{active:e.isCurrentSessionLoading,color:"#1C457D"}}),e._v(" "),!Object.keys(e.session).length&&e.currentOfficeId?s("router-link",{staticClass:"button primary",attrs:{to:"/EditSession"}},[e._v("Открыть смену")]):e._e()],1)],1)]),e._v(" "),Object.keys(e.session).length?s("div",{staticClass:"session-info grid-x align-middle"},[s("div",{staticClass:"session-info-block cell medium-auto small-6"},[s("span",{staticClass:"big-number"},[e._v(e._s(e.time))]),e._v(" "),s("label",[e._v(e._s(e.date))])]),e._v(" "),s("div",{staticClass:"session-info-block cell medium-auto small-6"},[s("span",{staticClass:"big-number"},[e._v(e._s(e.servicesCount))]),e._v(" "),s("label",[e._v("Услуг оказано")])]),e._v(" "),s("div",{staticClass:"session-info-block cell medium-auto small-6"},[s("span",{staticClass:"big-number"},[e._v(e._s(e.goodsCount))]),e._v(" "),s("label",[e._v("Товаров продано")])]),e._v(" "),s("div",{staticClass:"session-info-block cell medium-auto small-6"},[s("span",{staticClass:"big-number"},[e._v(e._s(e.revenue))]),e._v(" "),s("label",[e._v("Выручка, ₽")])]),e._v(" "),s("div",{staticClass:"session-info-block cell medium-auto small-6"},[s("span",{staticClass:"big-number"},[e._v(e._s(e.costs))]),e._v(" "),s("label",[e._v("Расход, ₽")])]),e._v(" "),s("div",{staticClass:"session-info-block cell medium-auto small-6"},[s("span",{staticClass:"big-number"},[e._v(e._s(e.bonus))]),e._v(" "),s("label",[e._v("Премия, ₽")])]),e._v(" "),s("div",{staticClass:"session-info-block cell medium-2 small-12"},[s("router-link",{staticClass:"button primary small",attrs:{to:"/EditSession/"+e.session.id.toString()}},[e._v("Изменить/закрыть смену")])],1)]):e._e(),e._v(" "),Object.keys(e.session).length?s("div",{staticClass:"session-content"},[s("div",{staticClass:"grid-x grid-margin-x grid-margin-y"},[e._l(e.session.employees,function(t){return"master"===t.role?s("employeeCard",{key:t.id,attrs:{employee:t}}):e._e()}),e._v(" "),e._l(e.session.employees,function(t){return"officeAdmin"===t.role?s("employeeCard",{key:t.id,attrs:{employee:t}}):e._e()}),e._v(" "),s("div",{staticClass:"cell large-6 columns card employee-card"},[s("div",{staticClass:"employee-card-footer grid-x grid-padding-x grid-padding-y"},[s("vue-element-loading",{attrs:{active:e.isExpenseSaving,color:"#1C457D"}}),e._v(" "),s("h4",{staticClass:"cell small-12"},[e._v("Внести расход")]),e._v(" "),s("div",{staticClass:"cell medium-6"},[s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.selectedSpendType,label:"name",options:e.spendTypes},on:{input:e.updateSpendSum},model:{value:e.selectedSpendType,callback:function(t){e.selectedSpendType=t},expression:"selectedSpendType"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell auto"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.spendSum,expression:"spendSum",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"Сумма"},domProps:{value:e.spendSum},on:{input:function(t){t.target.composing||(e.spendSum=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),s("div",{staticClass:"cell shrink"},[s("button",{staticClass:"button secondary",on:{click:e.saveExpense}},[e._v("Сохранить")])])],1)]),e._v(" "),e.session.operations?s("div",{staticClass:"cell small-12 columns card"},[s("div",{staticClass:"table-container"},[s("table",{staticClass:"operations-table hover"},[e._m(0),e._v(" "),s("tbody",e._l(e.session.operations,function(t){return s("tr",{key:t.id},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)}},[e._v("\n                    "+e._s(e.$store.getters.getTimeFromOperation(t))+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)},domProps:{innerHTML:e._s(e.$store.getters.getOperationContent(t))}})],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)}},[e._v("\n                    "+e._s(e.$store.getters.getEmployeeNameFromOperation(t))+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)}},[e._v("\n                    "+e._s(e.$store.getters.getOperationSum(t))+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)}},[e._v("\n                    "+e._s(e.$store.getters.getOperationBonus(t))+"\n                  ")])],1)])}))])])]):e._e(),e._v(" "),s("div",{staticClass:"cell large-6 columns"},[s("button",{staticClass:"button secondary",on:{click:e.changeOffice}},[e._v("Изменить отделение")])])],2)]):e._e()],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"sticky-header"},[e._v("Время")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Операция")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Сотрудник")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Сумма")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Премия")])])])}]};var k=s("VU/8")(E,S,!1,function(e){s("dPSK")},null,null).exports,I={name:"EditSession",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},mounted:function(){document.title=this.$route.meta.title,this.$route.params.id&&this.load(this.$route.params.id)},data:function(){return{isLoading:!1,isSaving:!1,loadingError:"",savingError:"",session:this.getEmptyItem()}},methods:{addAdmin:function(){this.session.employees.push({id:this.admins[0].id,role:"officeAdmin",workHours:6})},addMaster:function(){this.session.employees.push({id:this.masters[0].id,role:"master",workHours:6})},removeEmployee:function(e){var t=this.session.employees.findIndex(function(t){return t.id===e});this.session.employees.splice(t,1)},load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetSession/",{id:e,withOperations:!1}).then(function(e){var s=e.data;null===s.employees&&(s.employees=[]),s.dateOpened&&(s.dateOpened=t.moment.utc(s.dateOpened,"DD.MM.YYYY HH:mm").local()),s.dateClosed&&(s.dateClosed=t.moment.utc(s.dateClosed,"DD.MM.YYYY HH:mm").local()),t.session=s,t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(e){var t=this;this.isSaving=!0,this.savingError="";var s=this.session;e&&(s.state="closed",s.dateClosed=this.moment().utc()),null===s.dateClosed&&delete s.dateClosed,y.post("EditSession/",this.session).then(function(e){t.isSaving=!1,t.$store.dispatch("getCurrentSession"),t.$router.push("/")}).catch(function(e){t.savingError=e,t.isSaving=!1})},getEmptyItem:function(){return{id:null,dateOpened:this.moment().utc(),dateClosed:null,employees:[],officeId:this.$store.state.currentOfficeId,state:"open",openCash:0}}},computed:{offices:{get:function(){return this.$store.state.offices}},admins:{get:function(){return this.$store.state.employees.filter(function(e){return e.roles.includes("officeAdmin")})}},masters:{get:function(){return this.$store.state.employees.filter(function(e){return e.roles.includes("master")})}},selectedAdmins:{get:function(){return this.session.employees?this.session.employees.filter(function(e){return"officeAdmin"===e.role}):null},set:function(e){var t=this.session.employees.findIndex(function(t){return t.id===e.id});e.role="officeAdmin",this.session.employees.$set(t,e)}},selectedMasters:{get:function(){return this.session.employees?this.session.employees.filter(function(e){return"master"===e.role}):null},set:function(e){var t=this.session.employees.findIndex(function(t){return t.id===e.id});e.role="master",this.session.employees.$set(t,e)}},canEdit:function(){return"open"===this.session.state&&(this.session.id===this.$store.state.currentSession.id||!this.session.id)}}},T={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":e.canEdit?"session":"history"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[e.canEdit?s("li",[s("router-link",{attrs:{to:"/"}},[e._v("Назад")])],1):s("li",[s("router-link",{attrs:{to:"/SessionsHistory/"}},[e._v("Назад")])],1)])]),e._v(" "),s("h1",[e._v("Смена")]),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("div",{staticClass:"cell large-6"},[s("label",[e._v("Отделение")]),e._v(" "),s("v-select",{attrs:{clearable:!1,disabled:!e.canEdit,reduce:function(e){return e.id},value:e.session.officeId,label:"name",options:e.offices},model:{value:e.session.officeId,callback:function(t){e.$set(e.session,"officeId",t)},expression:"session.officeId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("h2",[e._v("Администраторы")]),e._v(" "),e._l(e.selectedAdmins,function(t,n){return s("div",{key:t.id},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Администратор "+e._s(n>0?n+1:""))]),e._v(" "),n>0&&e.canEdit?s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(s){e.removeEmployee(t.id)}}},[e._v("\n              Удалить\n            ")]):e._e()]),e._v(" "),s("v-select",{attrs:{clearable:!1,disabled:!e.canEdit,reduce:function(e){return e.id},value:t.id,label:"name",options:e.admins},model:{value:t.id,callback:function(s){e.$set(t,"id",s)},expression:"admin.id"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Продолжительность смены, часы")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.workHours,expression:"admin.workHours"}],attrs:{type:"number",disabled:!e.canEdit},domProps:{value:t.workHours},on:{input:function(s){s.target.composing||e.$set(t,"workHours",s.target.value)}}})],1)}),e._v(" "),e.canEdit?s("div",[s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.addAdmin}},[e._v("Добавить администратора")])]):e._e(),e._v(" "),s("h2",[e._v("Мастера")]),e._v(" "),e._l(e.selectedMasters,function(t,n){return s("div",{key:t.id},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Мастер "+e._s(n>0?n+1:""))]),e._v(" "),n>0&&e.canEdit?s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(s){e.removeEmployee(t.id)}}},[e._v("\n              Удалить\n            ")]):e._e()]),e._v(" "),s("v-select",{attrs:{clearable:!1,disabled:!e.canEdit,reduce:function(e){return e.id},value:t.id,label:"name",options:e.masters},model:{value:t.id,callback:function(s){e.$set(t,"id",s)},expression:"master.id"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Продолжительность смены, часы")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.workHours,expression:"master.workHours"}],attrs:{type:"number",disabled:!e.canEdit},domProps:{value:t.workHours},on:{input:function(s){s.target.composing||e.$set(t,"workHours",s.target.value)}}})],1)}),e._v(" "),e.canEdit?s("div",[s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.addMaster}},[e._v("Добавить мастера")])]):e._e(),e._v(" "),e.canEdit?s("div",{staticClass:"grid-x align-justify"},[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary cell shrink",attrs:{type:"button"},on:{click:function(t){e.save(!1)}}},[e._v(e._s(e.session.id?"Сохранить":"Открыть смену"))]),e._v(" "),e.session.id?s("button",{staticClass:"button secondary alert cell shrink",attrs:{type:"button"},on:{click:function(t){e.save(!0)}}},[e._v("Закрыть смену")]):e._e()],1):e._e(),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении смены")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],2)],1)])],1)},staticRenderFns:[]};var x=s("VU/8")(I,T,!1,function(e){s("jve6")},null,null).exports,$={name:"SessionsHistory",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},mounted:function(){document.title=this.$route.meta.title,this.load()},data:function(){return{dateFrom:null,dateTo:null,selectedOperationTypes:[],employeeIds:[],clientIds:[],officeIds:[],isLoading:!1,loadingError:"",noSessions:!1,sessions:[]}},methods:{load:function(){var e=this;this.isLoading=!0,this.noSessions=!1;var t={withOperations:!0};this.dateFrom&&(t.dateFrom=this.moment(this.dateFrom).format("DD.MM.YYYY")),this.dateTo&&(t.dateTo=this.moment(this.dateTo).format("DD.MM.YYYY")),this.selectedOperationTypes&&this.selectedOperationTypes.length>0&&(t.operationType=this.selectedOperationTypes),this.employeeIds&&this.employeeIds.length>0&&(t.employeeIds=this.employeeIds),this.clientIds&&this.clientIds.length>0&&(t.clientIds=this.clientIds),this.officeIds&&this.officeIds.length>0&&(t.officeIds=this.officeIds),y.post("GetSessions/",t).then(function(t){e.sessions=t.data,Array.isArray(e.sessions)||(e.noSessions=!0),e.isLoading=!1}).catch(function(t){e.loadingError=t,e.isLoading=!1})}},computed:{operationTypes:{get:function(){return this.$store.state.operationTypes}},offices:{get:function(){return this.$store.state.offices}},employees:{get:function(){return this.$store.state.employees}},clients:{get:function(){return this.$store.state.clients}}}},L={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"history"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("История смен и операций")]),e._v(" "),s("div",{staticClass:"grid-x grid-padding-x no-padding-small"},[s("div",{staticClass:"cell large-4 small-12"},[s("label",[e._v("Дата от")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.dateFrom,expression:"dateFrom"}],attrs:{type:"date"},domProps:{value:e.dateFrom},on:{input:function(t){t.target.composing||(e.dateFrom=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"cell large-4 small-12"},[s("label",[e._v("Дата до")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.dateTo,expression:"dateTo"}],attrs:{type:"date"},domProps:{value:e.dateTo},on:{input:function(t){t.target.composing||(e.dateTo=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"cell large-4 small-12"},[s("label",[e._v("Типы операций")]),e._v(" "),s("v-select",{attrs:{multiple:"",reduce:function(e){return e.id},value:e.selectedOperationTypes,label:"name",options:e.operationTypes},model:{value:e.selectedOperationTypes,callback:function(t){e.selectedOperationTypes=t},expression:"selectedOperationTypes"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell large-4 small-12"},[s("label",[e._v("Отделения")]),e._v(" "),s("v-select",{attrs:{multiple:"",reduce:function(e){return e.id},value:e.officeIds,label:"name",options:e.offices},model:{value:e.officeIds,callback:function(t){e.officeIds=t},expression:"officeIds"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell large-4 small-12"},[s("label",[e._v("Клиенты")]),e._v(" "),s("v-select",{attrs:{multiple:"",reduce:function(e){return e.id},value:e.clientIds,"get-option-label":e.$store.getters.getClientDescription,options:e.clients},model:{value:e.clientIds,callback:function(t){e.clientIds=t},expression:"clientIds"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell large-4 small-12"},[s("label",[e._v("Сотрудники")]),e._v(" "),s("v-select",{attrs:{multiple:"",reduce:function(e){return e.id},value:e.employeeIds,label:"name",options:e.employees},model:{value:e.employeeIds,callback:function(t){e.employeeIds=t},expression:"employeeIds"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell small-12"},[s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.load}},[e._v("Показать")])])]),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),e.noSessions?s("div",[e._v("Не найдено данных, подходящих под заданные фильтры")]):e._e(),e._v(" "),e.isLoading?s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}})],1):e._e(),e._v(" "),e._l(e.sessions,function(t){return e.noSessions||e.isLoading?e._e():s("div",{key:t.id},[s("h4",[s("router-link",{attrs:{to:"/EditSession/"+t.id.toString()}},[e._v("Смена "+e._s(e.moment.utc(t.dateOpened,"DD.MM.YYYY HH:mm").local().format("DD.MM.YY"))+" "+e._s(e.$store.getters.getOfficeName(t.officeId)))])],1),e._v(" "),s("div",{staticClass:"table-container margin-bottom-30px"},[s("table",{staticClass:"operations-table hover"},[e._m(0,!0),e._v(" "),s("tbody",e._l(t.operations,function(t){return s("tr",{key:t},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)}},[e._v("\n                  "+e._s(e.$store.getters.getTimeFromOperation(t))+"\n                ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)}},[e._v("\n                  "+e._s(e.$store.getters.getEmployeeNameFromOperation(t))+"\n                ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)},domProps:{innerHTML:e._s(e.$store.getters.getOperationContent(t))}})],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)}},[e._v("\n                  "+e._s(e.$store.getters.getOperationSum(t))+"\n                ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)}},[e._v("\n                  "+e._s(e.$store.getters.getOperationBonus(t))+"\n                ")])],1)])}))])])])})],2)],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"sticky-header"},[e._v("Время")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Сотрудник")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Операция")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Сумма")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Премия")])])])}]};var P=s("VU/8")($,L,!1,function(e){s("zikU")},null,null).exports,w=s("Gu7T"),M=s.n(w),O={name:"EditService",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},created:function(){this.$route.params.id?this.load(this.$route.params.id):this.operations=this.getEmptyItem()},mounted:function(){document.title=this.$route.meta.title},data:function(){return{isLoading:!1,isSaving:!1,loadingError:"",savingError:"",operations:[],newClient:this.getEmptyClient()}},methods:{getEmptyItem:function(){return[{type:"serviceoperation",sessionId:this.currentSession.id,id:null,officeId:this.currentSession.officeId,serviceId:this.$route.query.serviceTypeId||this.serviceTypes[0].id,startDatetime:this.moment().subtract(1,"hours"),finishDatetime:this.moment(),adminId:this.$route.query.adminId||this.admins[0].id,masterId:this.$route.query.masterId||this.masters[0].id,clientId:null,cashSum:this.getServiceSum(this.$route.query.serviceTypeId,this.$route.query.masterId),cashlessSum:0,discountSum:0,adminBonusSum:0,masterBonusSum:0,clientRating:null,review:"",photos:null,comment:""}]},addItem:function(){this.operations.push({type:"goodsoperation",id:null,goodsId:this.goodsTypes[0].id,sessionId:this.currentSession.id,officeId:this.currentSession.officeId,datetime:null,adminId:this.service.adminId,employeeId:this.service.masterId,clientId:this.service.clientId,amount:1,cashSum:this.goodsTypes[0].price,cashlessSum:0,discountSum:0,adminBonusSum:0,employeeBonusSum:0,comment:""})},removeItem:function(e){var t=this.operations.findIndex(function(t){return"goodsoperation"===t.type&&t.goodsId===e.goodsId&&t.id===e.id});this.operations.splice(t,1)},updateServiceSum:function(){this.service.cashSum=this.getServiceSum(this.service.serviceId,this.service.masterId),this.service.cashlessSum=0},updateItemSum:function(e){e.cashSum=this.goodsTypes.filter(function(t){return t.id===e.goodsId})[0].price*e.amount,e.cashlessSum=0},updateExpenseSum:function(e){e.sum=this.employeePaymentTypes.filter(function(t){return t.id===e.expenseTypeId})[0].defaultSum},updateEmployeePaymentSum:function(e){e.sum=this.employeePaymentTypes.filter(function(t){return t.id===e.employeePaymentTypeId})[0].defaultSum},addExpense:function(){this.operations.push({type:"spendoperation",id:null,expenseTypeId:this.spendTypes[0].id,sessionId:this.currentSession.id,officeId:this.currentSession.officeId,datetime:null,sum:this.spendTypes[0].defaultSum,comment:""})},removeExpense:function(e){var t=this.operations.findIndex(function(t){return"spendoperation"===t.type&&t.expenseTypeId===e.expenseTypeId&&t.id===e.id});this.operations.splice(t,1)},addEmployeePayment:function(){this.operations.push({type:"employeepayment",id:null,employeePaymentTypeId:this.employeePaymentTypes[0].id,sessionId:this.currentSession.id,officeId:this.currentSession.officeId,datetime:null,employeeId:this.service.masterId,sum:this.employeePaymentTypes[0].defaultSum,comment:""})},removeEmployeePayment:function(e){var t=this.operations.findIndex(function(t){return"employeepayment"===t.type&&t.employeePaymentTypeId===e.employeePaymentTypeId&&t.id===e.id});this.operations.splice(t,1)},load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetServiceOperation/",{id:e}).then(function(e){var s=e.data;s.type="serviceoperation",s.startDatetime=t.moment.utc(s.startDatetime,"DD.MM.YYYY HH:mm").local(),s.finishDatetime=t.moment.utc(s.startDatetime,"DD.MM.YYYY HH:mm").local(),t.operations=[s],t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(){var e=this;this.isSaving=!0,this.savingError="";var t=this.operations;for(var s in t)"serviceoperation"===t[s].type?(t[s].adminBonusSum=this.getAdminBonus(t[s].cashSum+t[s].cashlessSum,t[s].adminId,t[s].type),t[s].masterBonusSum=this.getMasterBonus(t[s].cashSum+t[s].cashlessSum,t[s].masterId,t[s].type),t[s].startDatetime=t[s].startDatetime.utc(),t[s].finishDatetime=t[s].finishDatetime.utc()):"goodsoperation"===t[s].type?(t[s].adminBonusSum=this.getAdminBonus(t[s].cashSum+t[s].cashlessSum,t[s].adminId,t[s].type),t[s].employeeId&&t[s].employeeId!==t[s].adminId&&(t[s].employeeBonusSum=this.getEmployeeBonus(t[s].cashSum+t[s].cashlessSum,t[s].employeeId,t[s].type)),t[s].datetime=this.moment().utc()):t[s].datetime=this.moment().utc();if(this.operations=t,null===this.service.clientId){var n=this.newClient;null===n.photo&&delete n.photo,null===n.comment&&(n.comment=""),null!==n.contacts&&n.contacts!==[]||delete n.contacts,y.post("EditClient/",n).then(function(t){var s=t.data.id,n=e.operations;for(var i in n)"clientId"in n[i]&&(n[i].clientId=s);e.operations=n,y.post("EditOperations/",e.operations).then(function(t){e.$store.dispatch("getCurrentSession"),e.isSaving=!1,e.$router.push("/")}).catch(function(t){e.savingError=t,e.isSaving=!1})}).catch(function(t){e.savingError=t,e.isSaving=!1})}else y.post("EditOperations/",this.operations).then(function(t){e.$store.dispatch("getCurrentSession"),e.isSaving=!1,e.$router.push("/")}).catch(function(t){e.savingError=t,e.isSaving=!1})},getEmptyClient:function(){return{id:null,name:"",photo:null,contacts:[{type:"phone",value:""}]}},getServiceSum:function(e,t){var s=this.serviceTypes.filter(function(t){return t.id===e})[0],n=this.masters.filter(function(e){return e.id===t})[0],i=s.prices.filter(function(e){return e.category===n.categoryId});return i.length?parseInt(i[0].price):0},getAdminBonus:function(e,t,s){var n=this.admins.filter(function(e){return e.id===t})[0];return"serviceoperation"===s?e*n.servicePercent:"goodsoperation"===s?e*n.goodsPercent:void 0},getMasterBonus:function(e,t,s){var n=this.masters.filter(function(e){return e.id===t})[0];return"serviceoperation"===s?e*n.servicePercent:"goodsoperation"===s?e*n.goodsPercent:void 0},getEmployeeBonus:function(e,t,s){return e*this.employees.filter(function(e){return e.id===t})[0].goodsPercent},addContact:function(){this.newClient.contacts||(this.newClient.contacts=[]),this.newClient.contacts.push({type:"phone",value:""})},removeContact:function(e){this.newClient.contacts.splice(e,1)}},computed:{currentSession:{get:function(){return this.$store.state.currentSession}},serviceTypes:{get:function(){return this.$store.state.serviceTypes}},clients:{get:function(){var e=[].concat(M()(this.$store.state.clients));return e.unshift(this.getEmptyClient()),e}},admins:{get:function(){return this.currentSession&&d()(this.currentSession).length?this.currentSession.employees.filter(function(e){return"officeAdmin"===e.role}):this.$store.state.employees.filter(function(e){return e.roles.includes("officeAdmin")})}},masters:{get:function(){return this.currentSession&&d()(this.currentSession).length?this.currentSession.employees.filter(function(e){return"master"===e.role}):this.$store.state.employees.filter(function(e){return e.roles.includes("master")})}},employees:{get:function(){return this.currentSession&&d()(this.currentSession).length?this.currentSession.employees:this.$store.state.employees}},goodsTypes:{get:function(){return this.$store.state.goodsTypes}},spendTypes:{get:function(){return this.$store.state.spendTypes}},employeePaymentTypes:{get:function(){return this.$store.state.employeePaymentTypes}},contactTypes:{get:function(){return this.$store.state.contactTypes}},service:{get:function(){return this.operations.filter(function(e){return"serviceoperation"===e.type})[0]},set:function(e){var t=this.operations.findIndex(function(e){return"serviceoperation"===e.type})||0;this.operations.$set(t,e)}},soldGoods:{get:function(){return this.operations.filter(function(e){return"goodsoperation"===e.type})},set:function(e){var t=this.operations.findIndex(function(t){return"goodsoperation"===t.type&&t.goodsId===e.goodsId&&t.id===e.id});this.operations.$set(t,e)}},expenses:{get:function(){return this.operations.filter(function(e){return"spendoperation"===e.type})},set:function(e){var t=this.operations.findIndex(function(t){return"spendoperation"===t.type&&t.expenseTypeId===e.expenseTypeId&&t.id===e.id});this.operations.$set(t,e)}},employeePayments:{get:function(){return this.operations.filter(function(e){return"employeepayment"===e.type})},set:function(e){var t=this.operations.findIndex(function(t){return"employeepayment"===t.type&&t.employeePaymentTypeId===e.employeePaymentTypeId&&t.id===e.id&&t.employeeId===e.employeeId});this.operations.$set(t,e)}},canEdit:function(){return!!this.operations[0]&&(!this.operations[0].id||this.operations[0].sessionId===this.currentSession.id)},startTime:{get:function(){return this.service.startDatetime.format("HH:mm")},set:function(e){this.service.startDatetime=this.moment(e,"HH:mm")}},endTime:{get:function(){return this.service.finishDatetime.format("HH:mm")},set:function(e){this.service.finishDatetime=this.moment(e,"HH:mm")}}}},D={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":e.canEdit?"session":"history"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[e.canEdit?s("li",[s("router-link",{attrs:{to:"/"}},[e._v("Назад")])],1):s("li",[s("router-link",{attrs:{to:"/SessionsHistory"}},[e._v("История смен и операций")])],1)])]),e._v(" "),s("h1",[e._v("Услуга")]),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),e.service?s("div",{staticClass:"cell large-6"},[s("label",[e._v("Услуга")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.service.serviceId,label:"name",options:e.serviceTypes},on:{input:e.updateServiceSum},model:{value:e.service.serviceId,callback:function(t){e.$set(e.service,"serviceId",t)},expression:"service.serviceId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("div",{staticClass:"grid-x grid-margin-x"},[s("div",{staticClass:"cell medium-6"},[s("label",[e._v("Время начала")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.startTime,expression:"startTime"}],attrs:{type:"time"},domProps:{value:e.startTime},on:{input:function(t){t.target.composing||(e.startTime=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"cell medium-6"},[s("label",[e._v("Время завершения")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.endTime,expression:"endTime"}],attrs:{type:"time"},domProps:{value:e.endTime},on:{input:function(t){t.target.composing||(e.endTime=t.target.value)}}})])]),e._v(" "),s("label",[e._v("Администратор")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.service.adminId,label:"name",options:e.admins},model:{value:e.service.adminId,callback:function(t){e.$set(e.service,"adminId",t)},expression:"service.adminId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Мастер")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.service.masterId,label:"name",options:e.masters},model:{value:e.service.masterId,callback:function(t){e.$set(e.service,"masterId",t)},expression:"service.masterId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Клиент")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.service.clientId,"get-option-label":e.$store.getters.getClientDescription,options:e.clients},model:{value:e.service.clientId,callback:function(t){e.$set(e.service,"clientId",t)},expression:"service.clientId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),null===e.service.clientId?s("div",[s("label",[e._v("Имя")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.newClient.name,expression:"newClient.name"}],attrs:{type:"text",autofocus:""},domProps:{value:e.newClient.name},on:{input:function(t){t.target.composing||e.$set(e.newClient,"name",t.target.value)}}}),e._v(" "),e._l(e.newClient.contacts,function(t,n){return s("div",{key:t},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Контакт "+e._s(n>0?n+1:""))]),e._v(" "),s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(t){e.removeContact(n)}}},[e._v("\n                Удалить\n              ")])]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:t.type,label:"name",options:e.contactTypes},model:{value:t.type,callback:function(s){e.$set(t,"type",s)},expression:"contact.type"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"contact.value"}],attrs:{type:"text"},domProps:{value:t.value},on:{input:function(s){s.target.composing||e.$set(t,"value",s.target.value)}}})],1)}),e._v(" "),s("div",[s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.addContact}},[e._v("\n              Добавить контакт\n            ")])]),e._v(" "),s("label",[e._v("Комментарий к клиенту")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newClient.comment,expression:"newClient.comment"}],attrs:{rows:"3"},domProps:{value:e.newClient.comment},on:{input:function(t){t.target.composing||e.$set(e.newClient,"comment",t.target.value)}}})],2):e._e(),e._v(" "),s("label",[e._v("Сумма (наличка)")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.service.cashSum,expression:"service.cashSum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.service.cashSum},on:{input:function(t){t.target.composing||e.$set(e.service,"cashSum",e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Сумма (безнал)")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.service.cashlessSum,expression:"service.cashlessSum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.service.cashlessSum},on:{input:function(t){t.target.composing||e.$set(e.service,"cashlessSum",e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Скидка, руб.")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.service.discountSum,expression:"service.discountSum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.service.discountSum},on:{input:function(t){t.target.composing||e.$set(e.service,"discountSum",e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Оценка от клиента от 1 до 10")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.service.score,expression:"service.score",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.service.score},on:{input:function(t){t.target.composing||e.$set(e.service,"score",e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Отзыв клиента")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.service.review,expression:"service.review"}],attrs:{rows:"2"},domProps:{value:e.service.review},on:{input:function(t){t.target.composing||e.$set(e.service,"review",t.target.value)}}}),e._v(" "),s("label",[e._v("Комментарий")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.service.comment,expression:"service.comment"}],attrs:{rows:"2"},domProps:{value:e.service.comment},on:{input:function(t){t.target.composing||e.$set(e.service,"comment",t.target.value)}}}),e._v(" "),e.canEdit?s("div",[s("h2",[e._v("Проданные товары")]),e._v(" "),e._l(e.soldGoods,function(t,n){return s("div",{key:t.id},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Товар "+e._s(n>0?n+1:""))]),e._v(" "),e.canEdit?s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(s){e.removeItem(t)}}},[e._v("\n                Удалить\n              ")]):e._e()]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:t.goodsId,label:"name",options:e.goodsTypes},on:{input:function(s){e.updateItemSum(t)}},model:{value:t.goodsId,callback:function(s){e.$set(t,"goodsId",s)},expression:"soldItem.goodsId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Количество")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.amount,expression:"soldItem.amount",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.amount},on:{input:[function(s){s.target.composing||e.$set(t,"amount",e._n(s.target.value))},function(s){e.updateItemSum(t)}],blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Сумма (наличка)")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.cashSum,expression:"soldItem.cashSum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.cashSum},on:{input:function(s){s.target.composing||e.$set(t,"cashSum",e._n(s.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Сумма (безнал)")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.cashlessSum,expression:"soldItem.cashlessSum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.cashlessSum},on:{input:function(s){s.target.composing||e.$set(t,"cashlessSum",e._n(s.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Скидка, руб.")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.discountSum,expression:"soldItem.discountSum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.discountSum},on:{input:function(s){s.target.composing||e.$set(t,"discountSum",e._n(s.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Комментарий")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"soldItem.comment"}],attrs:{rows:"2"},domProps:{value:t.comment},on:{input:function(s){s.target.composing||e.$set(t,"comment",s.target.value)}}})],1)}),e._v(" "),s("div",[e.canEdit?s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.addItem}},[e._v("\n              Добавить товар\n            ")]):e._e()]),e._v(" "),s("h2",[e._v("Расходы")]),e._v(" "),e._l(e.expenses,function(t,n){return s("div",{key:t.id},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Расход "+e._s(n>0?n+1:""))]),e._v(" "),e.canEdit?s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(s){e.removeExpense(t)}}},[e._v("\n                Удалить\n              ")]):e._e()]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:t.expenseTypeId,label:"name",options:e.spendTypes},on:{input:function(s){e.updateExpenseSum(t)}},model:{value:t.expenseTypeId,callback:function(s){e.$set(t,"expenseTypeId",s)},expression:"expense.expenseTypeId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Сумма")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.sum,expression:"expense.sum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.sum},on:{input:function(s){s.target.composing||e.$set(t,"sum",e._n(s.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Комментарий")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"expense.comment"}],attrs:{rows:"2"},domProps:{value:t.comment},on:{input:function(s){s.target.composing||e.$set(t,"comment",s.target.value)}}})],1)}),e._v(" "),e.canEdit?s("div",[s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.addExpense}},[e._v("\n              Добавить расход\n            ")])]):e._e(),e._v(" "),s("h2",[e._v("Выплаты мастеру")]),e._v(" "),e._l(e.employeePayments,function(t,n){return s("div",{key:t.id},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Выплата мастеру "+e._s(n>0?n+1:""))]),e._v(" "),e.canEdit?s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(s){e.removeEmployeePayment(t)}}},[e._v("\n                Удалить\n              ")]):e._e()]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:t.employeePaymentTypeId,label:"name",options:e.employeePaymentTypes},on:{input:function(s){e.updateEmployeePaymentSum(t)}},model:{value:t.employeePaymentTypeId,callback:function(s){e.$set(t,"employeePaymentTypeId",s)},expression:"payment.employeePaymentTypeId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Сумма")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.sum,expression:"payment.sum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.sum},on:{input:function(s){s.target.composing||e.$set(t,"sum",e._n(s.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Комментарий")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"payment.comment"}],attrs:{rows:"2"},domProps:{value:t.comment},on:{input:function(s){s.target.composing||e.$set(t,"comment",s.target.value)}}})],1)}),e._v(" "),e.canEdit?s("div",[s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.addEmployeePayment}},[e._v("\n              Добавить выплату мастеру\n            ")])]):e._e()],2):e._e(),e._v(" "),e.canEdit?s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")])],1):e._e(),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],1):e._e()],1)])],1)},staticRenderFns:[]};var j=s("VU/8")(O,D,!1,function(e){s("356v")},null,null).exports,N={name:"EditGoodsSell",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},created:function(){this.adminId=this.$route.query.adminId||this.admins[0].id,this.employeeId=this.$route.query.employeeId,this.operations=[this.getEmptyItem()],this.$route.params.id&&this.load(this.$route.params.id),document.title=this.$route.meta.title},data:function(){return{isLoading:!1,isSaving:!1,loadingError:"",savingError:"",newClient:this.getEmptyClient(),operations:[],adminId:null,employeeId:null,clientId:null,time:this.moment().format("HH:mm")}},methods:{addItem:function(){this.operations.push(this.getEmptyItem())},removeItem:function(e){var t=this.operations.findIndex(function(t){return"goodsoperation"===t.type&&t.goodsId===e.goodsId&&t.id===e.id});this.operations.splice(t,1)},getEmptyItem:function(){return{type:"goodsoperation",id:null,goodsId:this.$route.query.goodTypeId||this.goodsTypes[0].id,sessionId:this.currentSession.id,officeId:this.currentSession.officeId,datetime:null,adminId:this.adminId,employeeId:this.employeeId,clientId:null,amount:1,cashSum:this.goodsTypes[0].price,cashlessSum:0,discountSum:0,adminBonusSum:0,employeeBonusSum:0,comment:""}},updateSum:function(e,t){e.cashSum=this.goodsTypes.filter(function(t){return t.id===e.goodsId})[0].price*e.amount,e.cashlessSum=0,this.$set(this.operations,t,e)},load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetGoodsOperation/",{id:e}).then(function(e){var s=e.data;s.type="goodsoperation",s.datetime=t.moment.utc(s.datetime,"DD.MM.YYYY HH:mm").local(),t.operations=[s],t.adminId=s.adminId,t.employeeId=s.employeeId,t.clientId=s.clientId,t.time=s.datetime.format("HH:mm"),t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(){var e=this;this.isSaving=!0,this.savingError="";var t=this.operations;for(var s in t)t[s].adminBonusSum=this.getAdminBonus(t[s].cashSum+t[s].cashlessSum,t[s].adminId,t[s].type),t[s].employeeId&&t[s].employeeId!==t[s].adminId&&(t[s].employeeBonusSum=this.getEmployeeBonus(t[s].cashSum+t[s].cashlessSum,t[s].employeeId,t[s].type)),t[s].adminId=this.adminId,t[s].employeeId=this.employeeId,t[s].clientId=this.clientId,t[s].datetime=this.moment(this.time,"HH:mm").utc();if(this.operations=t,null===this.clientId){var n=this.newClient;null===n.photo&&delete n.photo,null===n.comment&&(n.comment=""),null!==n.contacts&&n.contacts!==[]||delete n.contacts,y.post("EditClient/",n).then(function(t){var s=t.data.id,n=e.operations;for(var i in n)"clientId"in n[i]&&(n[i].clientId=s);e.operations=n,y.post("EditOperations/",e.operations).then(function(t){e.$store.dispatch("getCurrentSession"),e.isSaving=!1,e.$router.push("/")}).catch(function(t){e.savingError=t,e.isSaving=!1})}).catch(function(t){e.savingError=t,e.isSaving=!1})}else{var i=this.clientId;for(s in t=this.operations)"clientId"in t[s]&&(t[s].clientId=i);this.operations=t,y.post("EditOperations/",this.operations).then(function(t){e.$store.dispatch("getCurrentSession"),e.$router.push("/"),e.isSaving=!1}).catch(function(t){e.savingError=t,e.isSaving=!1})}},getEmptyClient:function(){return{id:null,name:"",photo:null,contacts:[{type:"phone",value:""}]}},getAdminBonus:function(e,t,s){var n=this.admins.filter(function(e){return e.id===t})[0];return"serviceoperation"===s?e*n.servicePercent:"goodsoperation"===s?e*n.goodsPercent:void 0},getEmployeeBonus:function(e,t,s){var n=this.employees.filter(function(e){return e.id===t})[0];return"serviceoperation"===s?e*n.servicePercent:"goodsoperation"===s?e*n.goodsPercent:void 0},addContact:function(){this.newClient.contacts||(this.newClient.contacts=[]),this.newClient.contacts.push({type:"phone",value:""})},removeContact:function(e){this.newClient.contacts.splice(e,1)}},computed:{currentSession:{get:function(){return this.$store.state.currentSession}},clients:{get:function(){var e=[].concat(M()(this.$store.state.clients));return e.unshift(this.getEmptyClient()),e}},admins:{get:function(){return this.currentSession&&d()(this.currentSession).length?this.currentSession.employees.filter(function(e){return"officeAdmin"===e.role}):this.$store.state.employees.filter(function(e){return e.roles.includes("officeAdmin")})}},employees:{get:function(){return this.currentSession&&d()(this.currentSession).length?this.currentSession.employees:this.$store.state.employees}},goodsTypes:{get:function(){return this.$store.state.goodsTypes}},contactTypes:{get:function(){return this.$store.state.contactTypes}},canEdit:function(){return!!this.operations[0]&&(!this.operations[0].id||this.operations[0].sessionId===this.currentSession.id)}}},Y={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":e.canEdit?"session":"history"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[e.canEdit?s("li",[s("router-link",{attrs:{to:"/"}},[e._v("Назад")])],1):s("li",[s("router-link",{attrs:{to:"/SessionsHistory"}},[e._v("История смен и операций")])],1)])]),e._v(" "),s("h1",[e._v("Продажа товаров")]),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),e.operations.length?s("div",{staticClass:"cell large-6"},[s("label",[e._v("Время")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.time,expression:"time"}],attrs:{type:"time"},domProps:{value:e.time},on:{input:function(t){t.target.composing||(e.time=t.target.value)}}}),e._v(" "),s("label",[e._v("Администратор")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.adminId,label:"name",options:e.admins},model:{value:e.adminId,callback:function(t){e.adminId=t},expression:"adminId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Сотрудник, которому пойдёт продажа в премию, кроме администратора")]),e._v(" "),s("v-select",{attrs:{reduce:function(e){return e.id},value:e.employeeId,label:"name",options:e.employees},model:{value:e.employeeId,callback:function(t){e.employeeId=t},expression:"employeeId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Клиент")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.clientId,"get-option-label":e.$store.getters.getClientDescription,options:e.clients},model:{value:e.clientId,callback:function(t){e.clientId=t},expression:"clientId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),null===e.clientId?s("div",[s("label",[e._v("Имя")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.newClient.name,expression:"newClient.name"}],attrs:{type:"text",autofocus:""},domProps:{value:e.newClient.name},on:{input:function(t){t.target.composing||e.$set(e.newClient,"name",t.target.value)}}}),e._v(" "),e._l(e.newClient.contacts,function(t,n){return s("div",{key:t},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Контакт "+e._s(n>0?n+1:""))]),e._v(" "),s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(t){e.removeContact(n)}}},[e._v("\n                Удалить\n              ")])]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:t.type,label:"name",options:e.contactTypes},model:{value:t.type,callback:function(s){e.$set(t,"type",s)},expression:"contact.type"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"contact.value"}],attrs:{type:"text"},domProps:{value:t.value},on:{input:function(s){s.target.composing||e.$set(t,"value",s.target.value)}}})],1)}),e._v(" "),s("div",[s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.addContact}},[e._v("\n              Добавить контакт\n            ")])]),e._v(" "),s("label",[e._v("Комментарий к клиенту")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newClient.comment,expression:"newClient.comment"}],attrs:{rows:"3"},domProps:{value:e.newClient.comment},on:{input:function(t){t.target.composing||e.$set(e.newClient,"comment",t.target.value)}}})],2):e._e(),e._v(" "),e._l(e.operations,function(t,n){return s("div",{key:t.id},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Товар "+e._s(n>0?n+1:""))]),e._v(" "),e.canEdit&&n>0?s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(s){e.removeItem(t)}}},[e._v("\n              Удалить\n            ")]):e._e()]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:t.goodsId,label:"name",options:e.goodsTypes},on:{input:function(s){e.updateSum(t,n)}},model:{value:t.goodsId,callback:function(s){e.$set(t,"goodsId",s)},expression:"soldItem.goodsId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Количество")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.amount,expression:"soldItem.amount",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.amount},on:{input:[function(s){s.target.composing||e.$set(t,"amount",e._n(s.target.value))},function(s){e.updateSum(t,n)}],blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Сумма (наличка)")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.cashSum,expression:"soldItem.cashSum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.cashSum},on:{input:function(s){s.target.composing||e.$set(t,"cashSum",e._n(s.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Сумма (безнал)")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.cashlessSum,expression:"soldItem.cashlessSum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.cashlessSum},on:{input:function(s){s.target.composing||e.$set(t,"cashlessSum",e._n(s.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Скидка, руб.")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.discountSum,expression:"soldItem.discountSum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.discountSum},on:{input:function(s){s.target.composing||e.$set(t,"discountSum",e._n(s.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Комментарий")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"soldItem.comment"}],attrs:{rows:"2"},domProps:{value:t.comment},on:{input:function(s){s.target.composing||e.$set(t,"comment",s.target.value)}}})],1)}),e._v(" "),s("div",[e.canEdit?s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.addItem}},[e._v("\n            Добавить товар\n          ")]):e._e()]),e._v(" "),e.canEdit?s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")])],1):e._e(),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],2):e._e()],1)])],1)},staticRenderFns:[]};var F=s("VU/8")(N,Y,!1,function(e){s("gTcm")},null,null).exports,H={name:"EditEmployeePayment",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},created:function(){this.operations=[this.getEmptyItem()],this.$route.params.id&&this.load(this.$route.params.id),document.title=this.$route.meta.title},data:function(){return{isLoading:!1,isSaving:!1,loadingError:"",savingError:"",operations:[],time:this.moment().format("HH:mm")}},methods:{addItem:function(){this.operations.push(this.getEmptyItem())},removeItem:function(e){var t=this.operations.findIndex(function(t){return"employeepayment"===t.type&&t.employeePaymentTypeId===e.employeePaymentTypeId&&t.id===e.id});this.operations.splice(t,1)},getEmptyItem:function(){return{type:"employeepayment",id:null,employeePaymentTypeId:this.$route.query.employeePaymentTypeId||this.employeePaymentTypes[0].id,sessionId:this.currentSession.id,officeId:this.currentSession.officeId,datetime:null,employeeId:this.employees[0].id,sum:this.employeePaymentTypes[0].defaultSum,comment:""}},updateSum:function(e){e.sum=this.employeePaymentTypes.filter(function(t){return t.id===e.employeePaymentTypeId})[0].defaultSum},load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetEmployeePaymentOperation/",{id:e}).then(function(e){var s=e.data;s.type="employeepayment",s.datetime=t.moment.utc(s.datetime,"DD.MM.YYYY HH:mm").local(),t.operations=[s],t.time=s.datetime.format("HH:mm"),t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(){var e=this;this.isSaving=!0,this.savingError="";var t=this.operations;for(var s in t)t[s].datetime=this.moment(this.time,"HH:mm").utc();this.operations=t,y.post("EditOperations/",this.operations).then(function(t){e.$store.dispatch("getCurrentSession"),e.isSaving=!1,e.$router.push("/")}).catch(function(t){e.savingError=t,e.isSaving=!1})}},computed:{currentSession:{get:function(){return this.$store.state.currentSession}},employees:{get:function(){return this.currentSession&&d()(this.currentSession).length?this.currentSession.employees:this.$store.state.employees}},employeePaymentTypes:{get:function(){return this.$store.state.employeePaymentTypes}},canEdit:function(){return!!this.operations[0]&&(!this.operations[0].id||this.operations[0].sessionId===this.currentSession.id)}}},G={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":e.canEdit?"session":"history"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[e.canEdit?s("li",[s("router-link",{attrs:{to:"/"}},[e._v("Назад")])],1):s("li",[s("router-link",{attrs:{to:"/SessionsHistory"}},[e._v("История смен и операций")])],1)])]),e._v(" "),s("h1",[e._v("Выплата сотруднику")]),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),e.operations.length?s("div",{staticClass:"cell large-6"},[s("label",[e._v("Время")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.time,expression:"time"}],attrs:{type:"time"},domProps:{value:e.time},on:{input:function(t){t.target.composing||(e.time=t.target.value)}}}),e._v(" "),e._l(e.operations,function(t,n){return s("div",{key:t.id},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Выплата сотруднику "+e._s(n>0?n+1:""))]),e._v(" "),e.canEdit&&n>0?s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(s){e.removeItem(t)}}},[e._v("\n              Удалить\n            ")]):e._e()]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:t.employeePaymentTypeId,label:"name",options:e.employeePaymentTypes},on:{input:function(s){e.updateSum(t)}},model:{value:t.employeePaymentTypeId,callback:function(s){e.$set(t,"employeePaymentTypeId",s)},expression:"payment.employeePaymentTypeId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Сотрудник")]),e._v(" "),s("v-select",{attrs:{reduce:function(e){return e.id},value:t.employeeId,label:"name",options:e.employees},model:{value:t.employeeId,callback:function(s){e.$set(t,"employeeId",s)},expression:"payment.employeeId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Сумма")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.sum,expression:"payment.sum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.sum},on:{input:function(s){s.target.composing||e.$set(t,"sum",e._n(s.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Комментарий")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"payment.comment"}],attrs:{rows:"2"},domProps:{value:t.comment},on:{input:function(s){s.target.composing||e.$set(t,"comment",s.target.value)}}})],1)}),e._v(" "),s("div",[e.canEdit?s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.addItem}},[e._v("\n            Добавить выплату сотруднику\n          ")]):e._e()]),e._v(" "),e.canEdit?s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")])],1):e._e(),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],2):e._e()],1)])],1)},staticRenderFns:[]};var A=s("VU/8")(H,G,!1,function(e){s("oaog")},null,null).exports,R={name:"EditExpense",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},created:function(){document.title=this.$route.meta.title,this.$route.params.id?this.load(this.$route.params.id):this.operations=[this.getEmptyItem()]},data:function(){return{isLoading:!1,loadingError:!1,isSaving:!1,savingError:"",operations:[],time:this.moment().format("HH:mm")}},methods:{getEmptyItem:function(){return{type:"spendoperation",id:null,expenseTypeId:this.spendTypes[0].id,sessionId:this.currentSession.id,officeId:this.currentSession.officeId,datetime:this.moment(),sum:this.getSpendSum(this.spendTypes[0].id),comment:""}},updateSpendSum:function(e){e.sum=this.getSpendSum(e.expenseTypeId)},getSpendSum:function(e){return parseInt(this.spendTypes.filter(function(t){return t.id===e})[0].defaultSum)},addExpense:function(){this.operations.push(this.getEmptyItem())},removeExpense:function(e){var t=this.operations.findIndex(function(t){return"spendoperation"===t.type&&t.type===e.type&&t.id===e.id});this.operations.splice(t,1)},load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetSpendOperation/",{id:e}).then(function(e){var s=e.data;s.type="spendoperation",s.datetime=t.moment.utc(s.datetime,"DD.MM.YYYY HH:mm").local(),t.operations=[s],t.time=s.datetime.format("HH:mm"),t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(){var e=this;this.savingError="",this.isSaving=!0;var t=this.operations;for(var s in t)t[s].datetime=this.moment(this.time,"HH:mm").utc();this.operations=t,y.post("EditOperations/",this.operations).then(function(t){e.$store.dispatch("getCurrentSession"),e.isSaving=!1,e.$router.push("/")}).catch(function(t){e.savingError=t,e.isSaving=!1})}},computed:{currentSession:{get:function(){return this.$store.state.currentSession}},spendTypes:{get:function(){return this.$store.state.spendTypes}},canEdit:function(){return!!this.operations[0]&&(!this.operations[0].id||this.operations[0].sessionId===this.currentSession.id)}}},V={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":e.canEdit?"session":"history"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[e.canEdit?s("li",[s("router-link",{attrs:{to:"/Session"}},[e._v("Смена")])],1):s("li",[s("router-link",{attrs:{to:"/SessionsHistory"}},[e._v("История смен и операций")])],1)])]),e._v(" "),s("h1",[e._v("Расход")]),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),s("div",{staticClass:"cell large-6"},[s("label",[e._v("Время")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.time,expression:"time"}],attrs:{type:"time"},domProps:{value:e.time},on:{input:function(t){t.target.composing||(e.time=t.target.value)}}}),e._v(" "),e._l(e.operations,function(t,n){return s("div",{key:t.id},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Расход "+e._s(n>0?n+1:""))]),e._v(" "),e.canEdit&&n>0?s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(s){e.removeExpense(t)}}},[e._v("\n              Удалить\n            ")]):e._e()]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:t.expenseTypeId,label:"name",options:e.spendTypes},on:{input:function(s){e.updateSpendSum(t)}},model:{value:t.expenseTypeId,callback:function(s){e.$set(t,"expenseTypeId",s)},expression:"expense.expenseTypeId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Сумма")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.sum,expression:"expense.sum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.sum},on:{input:function(s){s.target.composing||e.$set(t,"sum",e._n(s.target.value))},blur:function(t){e.$forceUpdate()}}}),e._v(" "),s("label",[e._v("Комментарий")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"expense.comment"}],attrs:{rows:"2"},domProps:{value:t.comment},on:{input:function(s){s.target.composing||e.$set(t,"comment",s.target.value)}}})],1)}),e._v(" "),e.canEdit?s("div",[s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.addExpense}},[e._v("Добавить расход")])]):e._e(),e._v(" "),e.canEdit?s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")])],1):e._e(),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],2)],1)])],1)},staticRenderFns:[]};var U=s("VU/8")(R,V,!1,function(e){s("jSIZ")},null,null).exports,B={name:"EditClient",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},created:function(){document.title=this.$route.meta.title,this.$route.params.id&&this.load(this.$route.params.id)},data:function(){return{isLoading:!1,isSaving:!1,loadingError:"",savingError:"",client:this.getEmptyItem()}},methods:{addContact:function(){this.client.contacts||(this.client.contacts=[]),this.client.contacts.push({type:"phone",value:""})},removeContact:function(e){this.client.contacts.splice(e,1)},load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetClient/",{id:e}).then(function(e){t.client=e.data,t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(){var e=this;this.isSaving=!0,this.savingError="";var t=this.client;null===t.photo&&delete t.photo,null===t.comment&&(t.comment=""),null!==t.contacts&&t.contacts!==[]||delete t.contacts,delete t.operations,y.post("EditClient/",t).then(function(t){e.isSaving=!1}).catch(function(t){e.savingError=t,e.isSaving=!1})},saveAndAddMore:function(){this.save(),this.client=this.getEmptyItem(),this.$router.push("/EditClient")},getEmptyItem:function(){return{id:null,name:"",photo:null,contacts:[{type:"phone",value:""}],comment:""}}},computed:{contactTypes:{get:function(){return this.$store.state.contactTypes}}}},q={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"clients"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[s("li",[s("router-link",{attrs:{to:"/Clients"}},[e._v("Клиенты")])],1)])]),e._v(" "),s("h1",[e._v("Клиент")]),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("div",{staticClass:"cell large-6"},[s("label",[e._v("Имя")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.client.name,expression:"client.name"}],attrs:{type:"text",autofocus:""},domProps:{value:e.client.name},on:{input:function(t){t.target.composing||e.$set(e.client,"name",t.target.value)}}}),e._v(" "),e._l(e.client.contacts,function(t,n){return s("div",{key:t},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Контакт "+e._s(n>0?n+1:""))]),e._v(" "),s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(t){e.removeContact(n)}}},[e._v("\n              Удалить\n            ")])]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:t.type,label:"name",options:e.contactTypes},model:{value:t.type,callback:function(s){e.$set(t,"type",s)},expression:"contact.type"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"contact.value"}],attrs:{type:"text"},domProps:{value:t.value},on:{input:function(s){s.target.composing||e.$set(t,"value",s.target.value)}}})],1)}),e._v(" "),s("div",[s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.addContact}},[e._v("\n            Добавить контакт\n          ")])]),e._v(" "),s("label",[e._v("Комментарий")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.client.comment,expression:"client.comment"}],attrs:{rows:"3"},domProps:{value:e.client.comment},on:{input:function(t){t.target.composing||e.$set(e.client,"comment",t.target.value)}}}),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")]),e._v(" "),s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.saveAndAddMore}},[e._v("Сохранить и добавить ещё")])],1),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении клиента")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],2)],1),e._v(" "),e.client.id>0?s("div",[s("h2",[e._v("История операций по клиенту")]),e._v(" "),s("div",{staticClass:"table-container"},[s("table",{staticClass:"operations-table hover"},[e._m(0),e._v(" "),s("tbody",e._l(e.client.operations,function(t){return s("tr",{key:t.id},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)}},[e._v("\n                  "+e._s(e.$store.getters.getDateTimeFromOperation(t))+"\n                ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)}},[e._v("\n                  "+e._s(e.$store.getters.getEmployeeNameFromOperation(t))+"\n                ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)},domProps:{innerHTML:e._s(e.$store.getters.getOperationContent(t))}})],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)}},[e._v("\n                  "+e._s(e.$store.getters.getOperationSum(t))+"\n                ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:e.$store.getters.getOperationLink(t)}},[e._v("\n                  "+e._s(e.$store.getters.getOperationBonus(t))+"\n                ")])],1)])}))])])]):e._e()])],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"sticky-header"},[e._v("Дата")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Мастер")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Услуга / товар")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Сумма")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Премия")])])])}]};var z=s("VU/8")(B,q,!1,function(e){s("Nk2v")},null,null).exports,W={name:"Clients",components:{appMenu:f,VueElementLoading:a.a},mounted:function(){document.title=this.$route.meta.title,this.loadClients()},data:function(){return{q:"",clients:[],isLoading:!1,error:""}},methods:{loadClients:function(){var e=this;this.isLoading=!0,y.post("GetClients/",{q:this.q}).then(function(t){e.clients=t.data,e.isLoading=!1}).catch(function(t){e.error=t,e.isLoading=!1})}},watch:{clients:function(){""===this.q&&this.$store.commit("updateStore",{name:"clients",value:this.clients})}}},Z={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"clients"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("Клиенты "),s("router-link",{staticClass:"button no-margion",attrs:{to:"/EditClient/"}},[e._v("Добавить")])],1),e._v(" "),s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.q,expression:"q"}],staticClass:"input-group-field",attrs:{type:"text",placeholder:"Имя или контакт клиента"},domProps:{value:e.q},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;t.stopPropagation(),e.loadClients(t)},input:function(t){t.target.composing||(e.q=t.target.value)}}}),e._v(" "),s("div",{staticClass:"input-group-button"},[s("button",{staticClass:"button",attrs:{type:"button"},on:{click:e.loadClients}},[e._v("Найти")])])]),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),e.error?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.error))])]):e._e(),e._v(" "),s("div",{staticClass:"table-container"},[s("table",{staticClass:"hover"},[e._m(0),e._v(" "),s("tbody",e._l(e.clients,function(t){return s("tr",{key:t.id},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditClient/"+t.id}},[e._v("\n                  "+e._s(t.name)+"\n                ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditClient/"+t.id}},e._l(t.contacts,function(t,n){return s("div",{key:n},[e._v("\n                    "+e._s(e.$store.getters.getContactTypeName(t.type))+": "+e._s(t.value)+"\n                  ")])}))],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditClient/"+t.id}},[e._v("\n                  "+e._s(t.comment)+"\n                ")])],1)])}))])])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",{staticClass:"sticky-header"},[this._v("Имя")]),this._v(" "),t("th",{staticClass:"sticky-header"},[this._v("Контакты")]),this._v(" "),t("th",{staticClass:"sticky-header"},[this._v("Комментарий")])])])}]};var X=s("VU/8")(W,Z,!1,function(e){s("mpjx")},null,null).exports,K={name:"UploadExpenses",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},created:function(){document.title=this.$route.meta.title,this.load()},data:function(){return{isLoading:!1,loadingError:!1,isSaving:!1,savingError:"",sessions:[],byOffices:[],byEmployees:[],byOfficesAndEmployees:[],period:this.moment().format("MM YYYY")}},methods:{getEmptyExpense:function(e){return{type:"spendoperation",id:null,expenseTypeId:this.spendTypes[0].id,sum:this.getSpendSum(this.spendTypes[0].id),comment:""}},getEmptyEmployeePayment:function(e,t,s){return{type:"employeepayment",id:null,employeePaymentTypeId:t?this.employeePaymentTypes.filter(function(e){return e.type===t})[0].id:this.employeePaymentTypes[0].id,employeeId:e,sum:s,comment:""}},addEmployeePayment:function(e,t){t.push(this.getEmptyEmployeePayment(e))},removeEmployeePayment:function(e,t){var s=t.findIndex(function(t){return t.employeePaymentTypeId===e.employeePaymentTypeId&&t.sum===e.sum});t.splice(s,1)},updateSpendSum:function(e){e.sum=this.getSpendSum(e.expenseTypeId)},getSpendSum:function(e){return parseInt(this.spendTypes.filter(function(t){return t.id===e})[0].defaultSum)},updateEmployeePaymentSum:function(e){e.sum=this.employeePaymentTypes.filter(function(t){return t.id===e.employeePaymentTypeId})[0].defaultSum},addExpense:function(e,t){t.push(this.getEmptyExpense(e))},removeExpense:function(e,t){var s=t.findIndex(function(t){return"spendoperation"===t.type&&t.type===e.type&&t.id===e.id});t.splice(s,1)},load:function(){var e=this;this.isLoading=!0,this.loadingError="";var t=this.moment(this.period,"MM YYYY"),s={dateFrom:t.format("DD.MM.YYYY"),dateTo:t.add(1,"months").format("DD.MM.YYYY"),withOperations:!1};y.post("GetSessions/",s).then(function(t){e.sessions=t.data;var s={period:e.moment(e.period,"MM YYYY").format("DD.MM.YYYY")};y.post("GenerateFinanceReport/",s).then(function(t){var n=t.data.byOffices;for(var i in n){var a=n[i];a.operations=[e.getEmptyExpense(a.officeId)]}e.byOffices=t.data.byOffices,y.post("GenerateEmployeeReport/",s).then(function(t){var s=t.data.byEmployees;for(var n in s){var i=s[n];i.operations=[],i.totalunpaidsalary>0&&i.operations.push(e.getEmptyEmployeePayment(i.employeeId,"salary",i.totalunpaidsalary)),i.totalunpaidbonus>0&&i.operations.push(e.getEmptyEmployeePayment(i.employeeId,"bonus",i.totalunpaidbonus))}e.byEmployees=s,e.byOfficesAndEmployees=t.data.byOfficeAndEmployee,e.isLoading=!1}).catch(function(t){e.loadingError=t,e.isLoading=!1})}).catch(function(t){e.loadingError=t,e.isLoading=!1})}).catch(function(t){e.loadingError=t,e.isLoading=!1})},save:function(){var e=this;this.savingError="",this.isSaving=!0;var t=[];for(var s in this.byOffices){var n=this.byOffices[s];for(var i in n.operations){var a=n.operations[i],o=this.getSessionForOffice(n.officeId);a.sessionId=o.id,a.officeId=n.officeId,a.datetime=this.moment.utc(o.dateOpened,"DD.MM.YYYY HH:mm"),t.push(a)}}for(s in this.byEmployees){var r=this.byEmployees[s];for(i in r.operations)a=r.operations[i],o=this.getSessionForEmployee(r.employeeId),a.sessionId=o.id,a.officeId=n.officeId,a.datetime=this.moment.utc(o.dateOpened,"DD.MM.YYYY HH:mm"),t.push(a)}y.post("EditOperations/",t).then(function(t){e.isSaving=!1,e.load()}).catch(function(t){e.savingError=t,e.isSaving=!1})},sortSessionsByDate:function(e,t){var s=this.moment(e.dateOpened,"DD.MM.YYYY HH:mm"),n=this.moment(t.dateOpened,"DD.MM.YYYY HH:mm");return s.isBefore(n)?1:-1},getSessionForOffice:function(e){var t=this.sessions.filter(function(t){return t.officeId===e});return t.length?t.sort(this.sortSessionsByDate)[0]:this.sessions.sort(this.sortSessionsByDate)[0]},getSessionForEmployee:function(e){var t=this.sessions.filter(function(t){return t.employees.filter(function(t){return t.id===e}).length>0});return t.length?t.sort(this.sortSessionsByDate)[0]:this.sessions.sort(this.sortSessionsByDate)[0]},inclineWord:function(e,t,s,n){if(e){var i=e.toString()[e.toString().length-1];if(["5","6","7","8","9","0"].includes(i)||e%100>10&&e%100<20)return n;if(["2","3","4"].includes(i))return s;if("1"===i)return t}return t}},computed:{spendTypes:{get:function(){return this.$store.state.spendTypes}},employeePaymentTypes:{get:function(){return this.$store.state.employeePaymentTypes}},periods:function(){for(var e=[],t=0;t<=12;t++)e.push(this.moment().subtract(t,"months").format("MM YYYY"));return e}}},J={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("Внести расходы")]),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),s("div",[s("label",[e._v("Месяц")]),e._v(" "),s("v-select",{attrs:{clearable:!1,value:e.period,label:"name",options:e.periods},on:{input:e.load},model:{value:e.period,callback:function(t){e.period=t},expression:"period"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("h2",[e._v("Выплаты сотрудникам")]),e._v(" "),e._l(e.byEmployees,function(t){return s("div",{key:t.employeeId},[s("h3",[e._v(e._s(t.name))]),e._v(" "),s("div",{staticClass:"grid-x grid-margin-x grid-margin-y margin-bottom-10px"},[s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalsalary||0))]),e._v(" "),s("label",[e._v("Начисленная заплата, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalpaidsalary||0))]),e._v(" "),s("label",[e._v("Выплаченая зарплата, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalpenalty||0))]),e._v(" "),s("label",[e._v("Штрафы, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalunpaidsalary||0))]),e._v(" "),s("label",[e._v("Невыплаченая зарплата, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s((t.totalgoodsbonus||0)+(t.totalservicebonus||0)))]),e._v(" "),s("label",[e._v("Начисленная премия, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalservicebonus||0))]),e._v(" "),s("label",[e._v("Премия (услуги), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalgoodsbonus||0))]),e._v(" "),s("label",[e._v("Премия (товары), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalpaidbonus||0))]),e._v(" "),s("label",[e._v("Выплаченная премия, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalunpaidbonus||0))]),e._v(" "),s("label",[e._v("Невыплаченная премия, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.estimatedworkhours||0))]),e._v(" "),s("label",[e._v("Рабочие часы в месяце")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.total_time||0))]),e._v(" "),s("label",[e._v("Отработанные часы")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s((100*(t.meanworkload||0)).toFixed(2).toString()+"%"))]),e._v(" "),s("label",[e._v("% отработанных часов")])])]),e._v(" "),e._l(t.operations,function(n,i){return s("div",{key:n.id},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Выплата "+e._s(i+1))]),e._v(" "),s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(s){e.removeEmployeePayment(n,t.operations)}}},[e._v("\n                Удалить\n              ")])]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:n.employeePaymentTypeId,label:"name",options:e.employeePaymentTypes},on:{input:function(t){e.updateEmployeePaymentSum(n)}},model:{value:n.employeePaymentTypeId,callback:function(t){e.$set(n,"employeePaymentTypeId",t)},expression:"payment.employeePaymentTypeId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Сумма")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:n.sum,expression:"payment.sum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:n.sum},on:{input:function(t){t.target.composing||e.$set(n,"sum",e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})],1)}),e._v(" "),s("div",[s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:function(s){e.addEmployeePayment(t.employeeId,t.operations)}}},[e._v("\n              Добавить выплату сотруднику\n            ")])])],2)}),e._v(" "),s("h2",[e._v("Расходы по отделениям")]),e._v(" "),e._l(e.byOffices,function(t){return s("div",{key:t.officeId},[s("h3",[e._v(e._s(e.$store.getters.getOfficeName(t.officeId)))]),e._v(" "),s("div",{staticClass:"grid-x grid-margin-x grid-margin-y margin-bottom-10px"},[s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalincome.toFixed(2)||0))]),e._v(" "),s("label",[e._v("Выручка, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.serviceincome||0))]),e._v(" "),s("label",[e._v("Выручка (услуги), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.goodsincome||0))]),e._v(" "),s("label",[e._v("Выручка (товары), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalcash||0))]),e._v(" "),s("label",[e._v("Выручка (наличка), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalcashless||0))]),e._v(" "),s("label",[e._v("Выручка (безнал), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalspend||0))]),e._v(" "),s("label",[e._v("Расходы, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalprofit.toFixed(2)||0))]),e._v(" "),s("label",[e._v("Прибыль, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.operationcount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(t.operationcount,"Операция","Операции","Операций")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.serviceoperationcount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(t.operationcount,"Услуга оказана","Услуги оказано","Услуг оказано")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.goodsoperationcount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(t.operationcount,"Товар продан","Товара продано","Товаров продано")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.spendoperationcount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(t.operationcount,"Расход внесен","Расхода внесено","Расходов внесено")))])])]),e._v(" "),e._l(t.operations,function(n,i){return s("div",{key:n.id},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Расход "+e._s(i+1))]),e._v(" "),s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(s){e.removeExpense(n,t.operations)}}},[e._v("\n                Удалить\n              ")])]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:n.expenseTypeId,label:"name",options:e.spendTypes},on:{input:function(t){e.updateSpendSum(n)}},model:{value:n.expenseTypeId,callback:function(t){e.$set(n,"expenseTypeId",t)},expression:"expense.expenseTypeId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Сумма")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:n.sum,expression:"expense.sum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:n.sum},on:{input:function(t){t.target.composing||e.$set(n,"sum",e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})],1)}),e._v(" "),s("div",[s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:function(s){e.addExpense(t.officeId,t.operations)}}},[e._v("Добавить расход")])])],2)}),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")])],1),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],2)],1)])],1)},staticRenderFns:[]};var Q=s("VU/8")(K,J,!1,function(e){s("U4yb")},null,null).exports,ee={name:"Offices",components:{appMenu:f,VueElementLoading:a.a},mounted:function(){document.title=this.$route.meta.title,this.loadOffices()},data:function(){return{isLoading:!1,error:""}},methods:{loadOffices:function(){var e=this;this.isLoading=!0,y.post("GetOffices/",{}).then(function(t){e.offices=t.data,e.isLoading=!1}).catch(function(t){e.error=t,e.isLoading=!1})}},computed:{offices:{get:function(){return this.$store.state.offices},set:function(e){this.$store.commit("updateStore",{name:"offices",value:e})}}}},te={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("Отделения "),s("router-link",{staticClass:"button no-margin",attrs:{to:"/EditOffice/"}},[e._v("Добавить")])],1),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("table",{staticClass:"hover"},[e._m(0),e._v(" "),s("tbody",e._l(e.offices,function(t){return s("tr",{key:t.id},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditOffice/"+t.id}},[e._v("\n                "+e._s(t.name)+"\n              ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditOffice/"+t.id}},[e._v("\n                "+e._s(e.$store.getters.getOfficeStateName(t.state))+"\n              ")])],1)])}))])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("Название")]),this._v(" "),t("th",[this._v("Статус")])])])}]};var se=s("VU/8")(ee,te,!1,function(e){s("musY")},null,null).exports,ne={name:"EditOffice",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},mounted:function(){document.title=this.$route.meta.title,this.$route.params.id&&this.load(this.$route.params.id)},data:function(){return{isLoading:!1,isSaving:!1,loadingError:"",savingError:"",office:this.getEmptyItem()}},methods:{load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetOffice/",{id:e}).then(function(e){t.office=e.data,t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(e){var t=this;this.isSaving=!0,this.savingError="",y.post("EditOffice/",this.office).then(function(s){t.isSaving=!1,e||t.$router.push("/Offices")}).catch(function(e){t.savingError=e,t.isSaving=!1})},saveAndAddMore:function(){this.save(!0),this.office=this.getEmptyItem(),this.$router.push("/EditOffice")},getEmptyItem:function(){return{id:null,name:"",state:"open",city:"",address:"",coordinatex:0,coordinatey:0}}},computed:{officeStates:{get:function(){return this.$store.state.officeStates}}}},ie={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[s("li",[s("router-link",{attrs:{to:"/Offices"}},[e._v("Отделения")])],1)])]),e._v(" "),s("h1",[e._v("Отделение")]),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("div",{staticClass:"cell large-6"},[s("label",[e._v("Название")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.office.name,expression:"office.name"}],attrs:{type:"text",autofocus:""},domProps:{value:e.office.name},on:{input:function(t){t.target.composing||e.$set(e.office,"name",t.target.value)}}}),e._v(" "),s("label",[e._v("Статус")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.office.state,label:"name",options:e.officeStates},model:{value:e.office.state,callback:function(t){e.$set(e.office,"state",t)},expression:"office.state"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")]),e._v(" "),s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.saveAndAddMore}},[e._v("Сохранить и добавить ещё")])],1),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],1)],1)])],1)},staticRenderFns:[]};var ae=s("VU/8")(ne,ie,!1,function(e){s("IPdH")},null,null).exports,oe={name:"ServiceTypes",components:{appMenu:f,VueElementLoading:a.a},mounted:function(){document.title=this.$route.meta.title,this.loadData()},data:function(){return{isLoading:!1,error:""}},methods:{loadData:function(){var e=this;this.isLoading=!0,y.post("GetServicesPrices/",{}).then(function(t){e.serviceTypes=t.data,e.isLoading=!1}).catch(function(t){e.error=t,e.isLoading=!1})}},computed:{serviceTypes:{get:function(){return this.$store.state.serviceTypes},set:function(e){this.$store.commit("updateStore",{name:"serviceTypes",value:e})}}}},re={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("Услуги "),s("router-link",{staticClass:"button no-margion",attrs:{to:"/EditServiceType/"}},[e._v("Добавить")])],1),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("table",{staticClass:"hover"},[e._m(0),e._v(" "),s("tbody",e._l(e.serviceTypes,function(t){return s("tr",{key:t.id},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditServiceType/"+t.id}},[e._v("\n                "+e._s(t.name)+"\n              ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditServiceType/"+t.id}},e._l(t.prices,function(t){return s("div",{key:t},[t.category?s("span",[e._v("\n                    "+e._s(e.$store.getters.getMasterCategoryName(t.category))+": "+e._s(t.price)+" ₽\n                  ")]):e._e(),e._v(" "),t.category||0===t.category?e._e():s("span",[e._v("\n                    Все категории мастеров: "+e._s(t.price)+" ₽\n                  ")])])}))],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditServiceType/"+t.id}},[e._v("\n                "+e._s(e.$store.getters.getServiceStateName(t.state))+"\n              ")])],1)])}))])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("Название")]),this._v(" "),t("th",[this._v("Цены")]),this._v(" "),t("th",[this._v("Статус")])])])}]};var le=s("VU/8")(oe,re,!1,function(e){s("MHY7")},null,null).exports,ce={name:"EditServiceType",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},mounted:function(){document.title=this.$route.meta.title,this.$route.params.id&&this.load(this.$route.params.id)},data:function(){return{isLoading:!1,isSaving:!1,loadingError:"",savingError:"",serviceType:this.getEmptyItem()}},methods:{load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetService/",{id:e}).then(function(e){t.serviceType=e.data,t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(){var e=this;this.isSaving=!0,this.savingError="",y.post("EditService/",this.serviceType).then(function(t){e.isSaving=!1,e.$router.push({name:"ServiceTypes"})}).catch(function(t){e.savingError=t,e.isSaving=!1})},saveAndAddMore:function(){this.save(),this.serviceType=this.getEmptyItem(),this.$router.push("/EditServiceType")},getEmptyItem:function(){return{id:null,name:"",prices:this.getMergedPrices(),state:"active"}},getMergedPrices:function(){var e=this,t=[];return this.$store.state.masterCategories.map(function(s){var n=0;try{n=e.serviceType.prices.filter(function(e){return e.category===s.id})[0].price}catch(e){}t.push({category:s.id,price:parseInt(n)})}),t}},computed:{serviceStates:{get:function(){return this.$store.state.serviceStates}}}},ue={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[s("li",[s("router-link",{attrs:{to:"/ServiceTypes"}},[e._v("Услуги")])],1)])]),e._v(" "),s("h1",[e._v("Тип услуги")]),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("div",{staticClass:"cell large-6"},[s("label",[e._v("Название")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.serviceType.name,expression:"serviceType.name"}],attrs:{type:"text",autofocus:""},domProps:{value:e.serviceType.name},on:{input:function(t){t.target.composing||e.$set(e.serviceType,"name",t.target.value)}}}),e._v(" "),e._l(e.serviceType.prices,function(t){return s("div",{key:t},[s("label",[e._v("Категория мастера: "+e._s(e.$store.getters.getMasterCategoryName(t.category)))]),e._v(" "),s("label",[e._v("Цена")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.price,expression:"price.price",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.price},on:{input:function(s){s.target.composing||e.$set(t,"price",e._n(s.target.value))},blur:function(t){e.$forceUpdate()}}})])}),e._v(" "),s("label",[e._v("Статус")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.serviceType.state,label:"name",options:e.serviceStates},model:{value:e.serviceType.state,callback:function(t){e.$set(e.serviceType,"state",t)},expression:"serviceType.state"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")]),e._v(" "),s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.saveAndAddMore}},[e._v("Сохранить и добавить ещё")])],1),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],2)],1)])],1)},staticRenderFns:[]};var de=s("VU/8")(ce,ue,!1,function(e){s("7W36")},null,null).exports,me={name:"GoodsTypes",components:{appMenu:f,VueElementLoading:a.a},mounted:function(){document.title=this.$route.meta.title,this.loadData()},data:function(){return{isLoading:!1,error:""}},methods:{loadData:function(){var e=this;this.isLoading=!0,y.post("GetGoods/",{}).then(function(t){e.goodsTypes=t.data,e.isLoading=!1}).catch(function(t){e.error=t,e.isLoading=!1})}},computed:{goodsTypes:{get:function(){return this.$store.state.goodsTypes},set:function(e){this.$store.commit("updateStore",{name:"goodsTypes",value:e})}}}},ve={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("Товары "),s("router-link",{staticClass:"button no-margion",attrs:{to:"/EditGoodsType/"}},[e._v("Добавить")])],1),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("div",{staticClass:"table-container"},[s("table",{staticClass:"hover"},[e._m(0),e._v(" "),s("tbody",e._l(e.goodsTypes,function(t){return s("tr",{key:t.id},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditGoodsType/"+t.id}},[e._v("\n                  "+e._s(t.name)+"\n                ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditGoodsType/"+t.id}},[e._v("\n                  "+e._s(t.price)+"\n                ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditGoodsType/"+t.id}},[e._v("\n                  "+e._s(e.$store.getters.getGoodsStateName(t.state))+"\n                ")])],1)])}))])])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",{staticClass:"sticky-header"},[this._v("Название")]),this._v(" "),t("th",{staticClass:"sticky-header"},[this._v("Цена")]),this._v(" "),t("th",{staticClass:"sticky-header"},[this._v("Статус")])])])}]};var pe=s("VU/8")(me,ve,!1,function(e){s("/6eh")},null,null).exports,_e={name:"EditGoodsType",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},mounted:function(){document.title=this.$route.meta.title,this.$route.params.id&&this.load(this.$route.params.id)},data:function(){return{isLoading:!1,isSaving:!1,loadingError:"",savingError:"",goodsType:this.getEmptyItem()}},methods:{load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetGood/",{id:e}).then(function(e){t.goodsType=e.data,t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(){var e=this;this.isSaving=!0,this.savingError="",y.post("EditGood/",this.goodsType).then(function(t){e.isSaving=!1}).catch(function(t){e.savingError=t,e.isSaving=!1})},saveAndAddMore:function(){this.save(),this.goodsType=this.getEmptyItem(),this.$router.push("/EditGoodsType")},getEmptyItem:function(){return{id:null,name:"",price:"",state:"active"}}},computed:{goodsStates:{get:function(){return this.$store.state.goodsStates}}}},fe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[s("li",[s("router-link",{attrs:{to:"/GoodsTypes"}},[e._v("Товары")])],1)])]),e._v(" "),s("h1",[e._v("Товар")]),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("div",{staticClass:"cell large-6"},[s("label",[e._v("Название")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.goodsType.name,expression:"goodsType.name"}],attrs:{type:"text",autofocus:""},domProps:{value:e.goodsType.name},on:{input:function(t){t.target.composing||e.$set(e.goodsType,"name",t.target.value)}}}),e._v(" "),s("label",[e._v("Цена")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.goodsType.price,expression:"goodsType.price"}],attrs:{type:"number",autofocus:""},domProps:{value:e.goodsType.price},on:{input:function(t){t.target.composing||e.$set(e.goodsType,"price",t.target.value)}}}),e._v(" "),s("label",[e._v("Статус")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.goodsType.state,label:"name",options:e.goodsStates},model:{value:e.goodsType.state,callback:function(t){e.$set(e.goodsType,"state",t)},expression:"goodsType.state"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")]),e._v(" "),s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.saveAndAddMore}},[e._v("Сохранить и добавить ещё")])],1),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],1)],1)])],1)},staticRenderFns:[]};var ye=s("VU/8")(_e,fe,!1,function(e){s("4BPl")},null,null).exports,ge={name:"ExpenseTypes",components:{appMenu:f,VueElementLoading:a.a},mounted:function(){document.title=this.$route.meta.title,this.loadData()},data:function(){return{isLoading:!1,error:""}},methods:{loadData:function(){var e=this;this.isLoading=!0,y.post("GetSpendTypes/",{}).then(function(t){e.spendTypes=t.data,e.isLoading=!1}).catch(function(t){e.error=t,e.isLoading=!1})}},computed:{spendTypes:{get:function(){return this.$store.state.spendTypes},set:function(e){this.$store.commit("updateStore",{name:"spendTypes",value:e})}}}},he={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("Типы расходов "),s("router-link",{staticClass:"button no-margion",attrs:{to:"/EditExpenseType/"}},[e._v("Добавить")])],1),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("table",{staticClass:"hover"},[e._m(0),e._v(" "),s("tbody",e._l(e.spendTypes,function(t){return s("tr",{key:t.id},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditExpenseType/"+t.id}},[e._v("\n                "+e._s(t.name)+"\n              ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditExpenseType/"+t.id}},[e._v("\n                "+e._s(t.defaultSum)+"\n              ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditExpenseType/"+t.id}},[e._v("\n                "+e._s(e.$store.getters.getSpendTypeStateName(t.state))+"\n              ")])],1)])}))])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("Название")]),this._v(" "),t("th",[this._v("Сумма по умолчанию")]),this._v(" "),t("th",[this._v("Статус")])])])}]};var be=s("VU/8")(ge,he,!1,function(e){s("yID9")},null,null).exports,Ce={name:"EditExpenseType",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},mounted:function(){document.title=this.$route.meta.title,this.$route.params.id&&this.load(this.$route.params.id)},data:function(){return{isLoading:!1,isSaving:!1,loadingError:"",savingError:"",spendType:this.getEmptyItem()}},methods:{load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetSpendType/",{id:e}).then(function(e){t.spendType=e.data,t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(){var e=this;this.isSaving=!0,this.savingError="",y.post("EditSpendType/",this.spendType).then(function(t){e.isSaving=!1}).catch(function(t){e.savingError=t,e.isSaving=!1})},saveAndAddMore:function(){this.save(),this.spendType=this.getEmptyItem(),this.$router.push("/EditSpendType")},getEmptyItem:function(){return{id:null,name:"",defaultSum:0,state:"active"}}},computed:{spendTypeStates:{get:function(){return this.$store.state.spendTypeStates}}}},Ee={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[s("li",[s("router-link",{attrs:{to:"/ExpenseTypes"}},[e._v("Типы расходов")])],1)])]),e._v(" "),s("h1",[e._v("Тип расхода")]),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("div",{staticClass:"cell large-6"},[s("label",[e._v("Название")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.spendType.name,expression:"spendType.name"}],attrs:{type:"text",autofocus:""},domProps:{value:e.spendType.name},on:{input:function(t){t.target.composing||e.$set(e.spendType,"name",t.target.value)}}}),e._v(" "),s("label",[e._v("Сумма по умолчанию")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.spendType.defaultSum,expression:"spendType.defaultSum"}],attrs:{type:"number",autofocus:""},domProps:{value:e.spendType.defaultSum},on:{input:function(t){t.target.composing||e.$set(e.spendType,"defaultSum",t.target.value)}}}),e._v(" "),s("label",[e._v("Статус")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.spendType.state,label:"name",options:e.spendTypeStates},model:{value:e.spendType.state,callback:function(t){e.$set(e.spendType,"state",t)},expression:"spendType.state"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")]),e._v(" "),s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.saveAndAddMore}},[e._v("Сохранить и добавить ещё")])],1),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],1)],1)])],1)},staticRenderFns:[]};var Se=s("VU/8")(Ce,Ee,!1,function(e){s("AeFz")},null,null).exports,ke={name:"EmployeePaymentTypes",components:{appMenu:f,VueElementLoading:a.a},mounted:function(){document.title=this.$route.meta.title,this.loadData()},data:function(){return{isLoading:!1,error:""}},methods:{loadData:function(){var e=this;this.isLoading=!0,y.post("GetEmployeePaymentTypes/",{}).then(function(t){e.employeePaymentTypes=t.data,e.isLoading=!1}).catch(function(t){e.error=t,e.isLoading=!1})}},computed:{employeePaymentTypes:{get:function(){return this.$store.state.employeePaymentTypes},set:function(e){this.$store.commit("updateStore",{name:"employeePaymentTypes",value:e})}}}},Ie={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("Типы выплат сотрудникам "),s("router-link",{staticClass:"button no-margion",attrs:{to:"/EditEmployeePaymentType/"}},[e._v("Добавить")])],1),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("table",{staticClass:"hover"},[e._m(0),e._v(" "),s("tbody",e._l(e.employeePaymentTypes,function(t){return s("tr",{key:t.id},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditEmployeePaymentType/"+t.id}},[e._v("\n                "+e._s(t.name)+"\n              ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditEmployeePaymentType/"+t.id}},[e._v("\n                "+e._s(t.defaultSum)+"\n              ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditEmployeePaymentType/"+t.id}},[e._v("\n                "+e._s(e.$store.getters.getEmployeePaymentTypeTypeName(t.type))+"\n              ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditEmployeePaymentType/"+t.id}},[e._v("\n                "+e._s(e.$store.getters.getEmployeePaymentStateName(t.state))+"\n              ")])],1)])}))])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("Название")]),this._v(" "),t("th",[this._v("Сумма по умолчанию")]),this._v(" "),t("th",[this._v("Тип")]),this._v(" "),t("th",[this._v("Статус")])])])}]};var Te=s("VU/8")(ke,Ie,!1,function(e){s("TBX2")},null,null).exports,xe={name:"EditEmployeePaymentType",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},created:function(){document.title=this.$route.meta.title,this.$route.params.id?this.load(this.$route.params.id):this.employeePaymentType=this.getEmptyItem()},data:function(){return{isLoading:!1,isSaving:!1,loadingError:"",savingError:"",employeePaymentType:{}}},methods:{load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetEmployeePaymentType/",{id:e}).then(function(e){t.employeePaymentType=e.data,t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(){var e=this;this.isSaving=!0,this.savingError="",y.post("EditEmployeePaymentType/",this.employeePaymentType).then(function(t){e.isSaving=!1}).catch(function(t){e.savingError=t,e.isSaving=!1})},saveAndAddMore:function(){this.save(),this.employeePaymentType=this.getEmptyItem(),this.$router.push("/EditEmployeePaymentType")},getEmptyItem:function(){return{id:null,name:"",defaultSum:0,type:this.employeePaymentTypeTypes[0].id,state:"active"}}},computed:{employeePaymentTypeStates:{get:function(){return this.$store.state.employeePaymentTypeStates}},employeePaymentTypeTypes:{get:function(){return this.$store.state.employeePaymentTypeTypes}}}},$e={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[s("li",[s("router-link",{attrs:{to:"/EmployeePaymentTypes"}},[e._v("Типы выплат сотрудникам")])],1)])]),e._v(" "),s("h1",[e._v("Тип выплаты сотрудникам")]),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("div",{staticClass:"cell large-6"},[s("label",[e._v("Название")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.employeePaymentType.name,expression:"employeePaymentType.name"}],attrs:{type:"text",autofocus:""},domProps:{value:e.employeePaymentType.name},on:{input:function(t){t.target.composing||e.$set(e.employeePaymentType,"name",t.target.value)}}}),e._v(" "),s("label",[e._v("Сумма по умолчанию")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.employeePaymentType.defaultSum,expression:"employeePaymentType.defaultSum"}],attrs:{type:"number",autofocus:""},domProps:{value:e.employeePaymentType.defaultSum},on:{input:function(t){t.target.composing||e.$set(e.employeePaymentType,"defaultSum",t.target.value)}}}),e._v(" "),s("label",[e._v("Тип")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.employeePaymentType.type,label:"name",options:e.employeePaymentTypeTypes},model:{value:e.employeePaymentType.type,callback:function(t){e.$set(e.employeePaymentType,"type",t)},expression:"employeePaymentType.type"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Статус")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.employeePaymentType.state,label:"name",options:e.employeePaymentTypeStates},model:{value:e.employeePaymentType.state,callback:function(t){e.$set(e.employeePaymentType,"state",t)},expression:"employeePaymentType.state"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")]),e._v(" "),s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.saveAndAddMore}},[e._v("Сохранить и добавить ещё")])],1),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],1)],1)])],1)},staticRenderFns:[]};var Le=s("VU/8")(xe,$e,!1,function(e){s("Mrzp")},null,null).exports,Pe={name:"Employees",components:{appMenu:f,VueElementLoading:a.a},mounted:function(){document.title=this.$route.meta.title,this.loadData()},data:function(){return{isLoading:!1,error:""}},methods:{loadData:function(){var e=this;this.isLoading=!0,y.post("GetEmployees/",{}).then(function(t){e.employees=t.data,e.isLoading=!1}).catch(function(t){e.error=t,e.isLoading=!1})}},computed:{employees:{get:function(){return this.$store.state.employees},set:function(e){this.$store.commit("updateStore",{name:"employees",value:e})}}}},we={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("Сотрудники "),s("router-link",{staticClass:"button no-margion",attrs:{to:"/EditEmployee/"}},[e._v("Добавить")])],1),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("div",{staticClass:"table-container"},[s("table",{staticClass:"hover"},[e._m(0),e._v(" "),s("tbody",e._l(e.employees,function(t){return s("tr",{key:t.id},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditEmployee/"+t.id}},[e._v("\n                  "+e._s(t.name)+"\n                ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditEmployee/"+t.id}},e._l(t.roles,function(t){return s("div",{key:t},[e._v("\n                      "+e._s(e.$store.getters.getUserRoleName(t))+"\n                  ")])}))],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditEmployee/"+t.id}},[e._v("\n                  "+e._s(e.$store.getters.getMasterCategoryName(t.categoryId))+"\n                ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditEmployee/"+t.id}},[e._v("\n                  "+e._s(e.$store.getters.getEmployeeStateName(t.state))+"\n                ")])],1)])}))])])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",{staticClass:"sticky-header"},[this._v("Сотрудник")]),this._v(" "),t("th",{staticClass:"sticky-header"},[this._v("Роли")]),this._v(" "),t("th",{staticClass:"sticky-header"},[this._v("Категория мастера")]),this._v(" "),t("th",{staticClass:"sticky-header"},[this._v("Статус")])])])}]};var Me=s("VU/8")(Pe,we,!1,function(e){s("3hCC")},null,null).exports,Oe={name:"EditEmployee",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},mounted:function(){document.title=this.$route.meta.title,this.$route.params.id&&this.load(this.$route.params.id)},data:function(){return{isLoading:!1,isSaving:!1,loadingError:"",savingError:"",employee:this.getEmptyItem()}},methods:{addContact:function(){this.employee.contacts||(this.employee.contacts=[]),this.employee.contacts.push({type:"phone",value:""})},removeContact:function(e){this.employee.contacts.splice(e,1)},load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetEmployee/",{id:e}).then(function(e){t.employee=e.data,t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(){var e=this;this.isSaving=!0,this.savingError="";var t=this.employee;t.contacts&&0===t.contacts.length&&delete t.contacts,t.photo||delete t.photo,y.post("EditEmployee/",t).then(function(t){e.isSaving=!1}).catch(function(t){e.savingError=t,e.isSaving=!1})},saveAndAddMore:function(){this.save(),this.employee=this.getEmptyItem(),this.$router.push("/EditEmployee/")},getEmptyItem:function(){return{id:null,name:"",login:"",password:"",contacts:[],roles:["master"],photo:null,salary:0,servicePercent:.1,goodsPercent:.1,categoryId:0,state:"working"}}},computed:{userRoles:{get:function(){return this.$store.state.userRoles}},employeeStates:{get:function(){return this.$store.state.employeeStates}},contactTypes:{get:function(){return this.$store.state.contactTypes}},masterCategories:{get:function(){return this.$store.state.masterCategories}}}},De={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[s("li",[s("router-link",{attrs:{to:"/Employees"}},[e._v("Сотрудники")])],1)])]),e._v(" "),s("h1",[e._v("Сотрудник")]),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("div",{staticClass:"cell large-6"},[s("label",[e._v("Имя")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.employee.name,expression:"employee.name"}],attrs:{type:"text",autofocus:""},domProps:{value:e.employee.name},on:{input:function(t){t.target.composing||e.$set(e.employee,"name",t.target.value)}}}),e._v(" "),s("label",[e._v("Фото")]),e._v(" "),s("button",{staticClass:"button secondary",attrs:{type:"button"}},[e._v("Выбрать")]),e._v(" "),s("input",{ref:"photoSelector",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"}}),e._v(" "),s("label",[e._v("Статус")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.employee.state,label:"name",options:e.employeeStates},model:{value:e.employee.state,callback:function(t){e.$set(e.employee,"state",t)},expression:"employee.state"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Роли")]),e._v(" "),s("v-select",{attrs:{multiple:"",reduce:function(e){return e.id},value:e.employee.roles,label:"name",options:e.userRoles},model:{value:e.employee.roles,callback:function(t){e.$set(e.employee,"roles",t)},expression:"employee.roles"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Категория мастера")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.employee.categoryId,label:"name",options:e.masterCategories},model:{value:e.employee.categoryId,callback:function(t){e.$set(e.employee,"categoryId",t)},expression:"employee.categoryId"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("label",[e._v("Логин")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.employee.login,expression:"employee.login"}],attrs:{type:"text"},domProps:{value:e.employee.login},on:{input:function(t){t.target.composing||e.$set(e.employee,"login",t.target.value)}}}),e._v(" "),s("label",[e._v("Пароль")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.employee.password,expression:"employee.password"}],attrs:{type:"password"},domProps:{value:e.employee.password},on:{input:function(t){t.target.composing||e.$set(e.employee,"password",t.target.value)}}}),e._v(" "),e._l(e.employee.contacts,function(t,n){return s("div",{key:t},[s("label",{staticClass:"grid-x",on:{click:function(e){e.preventDefault()}}},[s("span",{staticClass:"cell auto"},[e._v("Контакт "+e._s(n>0?n+1:""))]),e._v(" "),s("button",{staticClass:"button clear small cell shrink no-margin",attrs:{type:"button"},on:{click:function(t){e.removeContact(n)}}},[e._v("\n              Удалить\n            ")])]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:t.type,label:"name",options:e.contactTypes},model:{value:t.type,callback:function(s){e.$set(t,"type",s)},expression:"contact.type"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"contact.value"}],attrs:{type:"text"},domProps:{value:t.value},on:{input:function(s){s.target.composing||e.$set(t,"value",s.target.value)}}})],1)}),e._v(" "),s("div",[s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.addContact}},[e._v("\n            Добавить контакт\n          ")])]),e._v(" "),s("label",[e._v("Оклад")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.employee.salary,expression:"employee.salary"}],attrs:{type:"number"},domProps:{value:e.employee.salary},on:{input:function(t){t.target.composing||e.$set(e.employee,"salary",t.target.value)}}}),e._v(" "),s("label",[e._v("% премии от услуг")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.employee.servicePercent,expression:"employee.servicePercent"}],attrs:{type:"number"},domProps:{value:e.employee.servicePercent},on:{input:function(t){t.target.composing||e.$set(e.employee,"servicePercent",t.target.value)}}}),e._v(" "),s("label",[e._v("% премии от товаров")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.employee.goodsPercent,expression:"employee.goodsPercent"}],attrs:{type:"number"},domProps:{value:e.employee.goodsPercent},on:{input:function(t){t.target.composing||e.$set(e.employee,"goodsPercent",t.target.value)}}}),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")]),e._v(" "),s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.saveAndAddMore}},[e._v("Сохранить и добавить ещё")])],1),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],2)],1)])],1)},staticRenderFns:[]};var je=s("VU/8")(Oe,De,!1,function(e){s("FZO8")},null,null).exports,Ne={name:"MasterTypes",components:{appMenu:f,VueElementLoading:a.a},mounted:function(){document.title=this.$route.meta.title,this.loadData()},data:function(){return{isLoading:!1,error:""}},methods:{loadData:function(){var e=this;this.isLoading=!0,y.post("GetBarberCategories/",{}).then(function(t){e.masterCategories=t.data,e.isLoading=!1}).catch(function(t){e.error=t,e.isLoading=!1})}},computed:{masterCategories:{get:function(){return this.$store.state.masterCategories},set:function(e){this.$store.commit("updateStore",{name:"masterCategories",value:e})}}}},Ye={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("Категории мастеров "),s("router-link",{staticClass:"button no-margion",attrs:{to:"/EditMasterType/"}},[e._v("Добавить")])],1),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("table",{staticClass:"hover"},[e._m(0),e._v(" "),s("tbody",e._l(e.masterCategories,function(t){return s("tr",{key:t.id},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditMasterType/"+t.id}},[e._v("\n                "+e._s(t.name)+"\n              ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:"/EditEmployeePaymentType/"+t.id}},[e._v("\n                "+e._s(e.$store.getters.getMasterCategoryStateName(t.state))+"\n              ")])],1)])}))])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("Категория")]),this._v(" "),t("th",[this._v("Статус")])])])}]};var Fe=s("VU/8")(Ne,Ye,!1,function(e){s("LbxH")},null,null).exports,He={name:"EditMasterType",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},mounted:function(){document.title=this.$route.meta.title,this.$route.params.id&&this.load(this.$route.params.id)},data:function(){return{isLoading:!1,isSaving:!1,loadingError:"",savingError:"",masterCategory:this.getEmptyItem()}},methods:{load:function(e){var t=this;this.isLoading=!0,this.loadingError="",y.post("GetBarberCategory/",{id:e}).then(function(e){t.masterCategory=e.data,t.isLoading=!1}).catch(function(e){t.loadingError=e,t.isLoading=!1})},save:function(){var e=this;this.isSaving=!0,this.savingError="",y.post("EditBarberCategory/",this.masterCategory).then(function(t){e.isSaving=!1}).catch(function(t){e.savingError=t,e.isSaving=!1})},saveAndAddMore:function(){this.save(),this.masterCategory=this.getEmptyItem(),this.$router.push("/EditMasterType")},getEmptyItem:function(){return{id:null,name:"",state:"active"}}},computed:{masterCategoryStates:{get:function(){return this.$store.state.masterCategoryStates}}}},Ge={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"admin"}}),e._v(" "),s("div",{staticClass:"content"},[s("nav",[s("ul",{staticClass:"breadcrumbs"},[s("li",[s("router-link",{attrs:{to:"/MasterTypes"}},[e._v("Категории мастеров")])],1)])]),e._v(" "),s("h1",[e._v("Категория мастера")]),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),s("div",{staticClass:"grid-x"},[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),s("div",{staticClass:"cell large-6"},[s("label",[e._v("Название")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.masterCategory.name,expression:"masterCategory.name"}],attrs:{type:"text",autofocus:""},domProps:{value:e.masterCategory.name},on:{input:function(t){t.target.composing||e.$set(e.masterCategory,"name",t.target.value)}}}),e._v(" "),s("label",[e._v("Статус")]),e._v(" "),s("v-select",{attrs:{clearable:!1,reduce:function(e){return e.id},value:e.masterCategory.state,label:"name",options:e.masterCategoryStates},model:{value:e.masterCategory.state,callback:function(t){e.$set(e.masterCategory,"state",t)},expression:"masterCategory.state"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])]),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isSaving,color:"#1C457D"}}),e._v(" "),s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.save}},[e._v("Сохранить")]),e._v(" "),s("button",{staticClass:"button secondary",attrs:{type:"button"},on:{click:e.saveAndAddMore}},[e._v("Сохранить и добавить ещё")])],1),e._v(" "),e.savingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при сохранении данных")]),e._v(" "),s("p",[e._v(e._s(e.savingError))])]):e._e()],1)],1)])],1)},staticRenderFns:[]};var Ae=s("VU/8")(He,Ge,!1,function(e){s("kxPN")},null,null).exports,Re=s("lHA8"),Ve=s.n(Re),Ue={name:"EmployeesReport",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},mounted:function(){document.title=this.$route.meta.title,this.load()},data:function(){return{period:this.moment().format("MM YYYY"),employeeIds:[],officeIds:[],isLoading:!1,loadingError:"",summary:null,byOffices:[],byEmployees:[],byOfficesAndEmployees:[]}},methods:{load:function(){var e=this;this.isLoading=!0,this.loadingError="";var t={period:this.moment(this.period,"MM YYYY").format("DD.MM.YYYY")};this.employeeIds&&this.employeeIds.length>0&&(t.employeeIds=this.employeeIds),this.officeIds&&this.officeIds.length>0&&(t.officeIds=this.officeIds),y.post("GenerateEmployeeReport/",t).then(function(t){if(e.summary=t.data.summary[0],!t.data.byOfficeAndEmployee.warning)for(var s in t.data.byOffices){var n=t.data.byOffices[s];n.employees=t.data.byOfficeAndEmployee.filter(function(e){return e.officeId===n.officeId}),n.detailsShown=!1,n.uniqueEmployeesCount=new Ve.a(n.employees.map(function(e){return e.employeeId})).size}e.byOffices=t.data.byOffices,e.byEmployees=t.data.byEmployees,e.byOfficesAndEmployees=t.data.byOfficeAndEmployee,e.isLoading=!1}).catch(function(t){e.loadingError=t,e.summary=null,e.byOffices=[],e.byEmployees=[],e.byOfficesAndEmployees=[],e.isLoading=!1})},inclineWord:function(e,t,s,n){if(e){var i=e.toString()[e.toString().length-1];if(["5","6","7","8","9","0"].includes(i)||e%100>10&&e%100<20)return n;if(["2","3","4"].includes(i))return s;if("1"===i)return t}return t},showOfficeDetails:function(e){e.detailsShown=!e.detailsShown}},computed:{offices:{get:function(){return this.$store.state.offices}},employees:{get:function(){return this.$store.state.employees}},periods:function(){for(var e=[],t=0;t<=12;t++)e.push(this.moment().subtract(t,"months").format("MM YYYY"));return e},uniqueEmployeesCount:function(){if(this.byEmployees&&this.byEmployees.length&&!this.byEmployees.warning&&!this.byEmployees.error)return new Ve.a(this.byEmployees.map(function(e){return e.employeeId})).size}}},Be={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"reports"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("Отчёт по сотрудникам")]),e._v(" "),s("div",{staticClass:"grid-x grid-padding-x no-padding-small"},[s("div",{staticClass:"cell large-4 small-12"},[s("label",[e._v("Месяц")]),e._v(" "),s("v-select",{attrs:{clearable:!1,value:e.period,label:"name",options:e.periods},model:{value:e.period,callback:function(t){e.period=t},expression:"period"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell large-4 small-12"},[s("label",[e._v("Отделения")]),e._v(" "),s("v-select",{attrs:{multiple:"",reduce:function(e){return e.id},value:e.officeIds,label:"name",options:e.offices},model:{value:e.officeIds,callback:function(t){e.officeIds=t},expression:"officeIds"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell large-4 small-12"},[s("label",[e._v("Сотрудники")]),e._v(" "),s("v-select",{attrs:{multiple:"",reduce:function(e){return e.id},value:e.employeeIds,label:"name",options:e.employees},model:{value:e.employeeIds,callback:function(t){e.employeeIds=t},expression:"employeeIds"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell small-12"},[s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.load}},[e._v("Показать")])])]),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),!e.loadingError&&!e.isLoading&&e.summary&&(!e.summary.totalsalary||e.byOffices.length&&e.byOffices.warning)?s("div",[e._v("Нет данных по выбранным фильтрам")]):e._e(),e._v(" "),!e.loadingError&&!e.isLoading&&e.summary&&e.summary.totalsalary?s("div",[s("h2",[e._v("Итого")]),e._v(" "),s("div",{staticClass:"grid-x grid-margin-x grid-margin-y margin-bottom-10px"},[s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.uniqueEmployeesCount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(e.uniqueEmployeesCount,"Сотрудник","Сотрудника","Сотрудников")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalsalary||0))]),e._v(" "),s("label",[e._v("Начисленная заплата, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalpaidsalary||0))]),e._v(" "),s("label",[e._v("Выплаченая зарплата, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalpenalty||0))]),e._v(" "),s("label",[e._v("Штрафы, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalunpaidsalary||0))]),e._v(" "),s("label",[e._v("Невыплаченая зарплата, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s((e.summary.totalgoodsbonus||0)+(e.summary.totalservicebonus||0)))]),e._v(" "),s("label",[e._v("Начисленная премия, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalservicebonus||0))]),e._v(" "),s("label",[e._v("Премия (услуги), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalgoodsbonus||0))]),e._v(" "),s("label",[e._v("Премия (товары), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalpaidbonus||0))]),e._v(" "),s("label",[e._v("Выплаченная премия, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalunpaidbonus||0))]),e._v(" "),s("label",[e._v("Невыплаченная премия, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.estimatedworkhours||0))]),e._v(" "),s("label",[e._v("Рабочие часы в месяце")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.total_time||0))]),e._v(" "),s("label",[e._v("Отработанные часы")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s((100*(e.summary.meanworkload||0)).toFixed(2).toString()+"%"))]),e._v(" "),s("label",[e._v("% отработанных часов")])])]),e._v(" "),s("div",{staticClass:"table-container margin-bottom-30px"},[s("table",{staticClass:"hover"},[e._m(0),e._v(" "),s("tbody",e._l(e.byEmployees,function(t){return s("tr",{key:t.employeeId},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s(t.name||"Неизвестно")+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s(t.totalsalary||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s(t.totalpenalty||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s(t.totalpaidsalary||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s(t.totalunpaidsalary||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s((t.totalgoodsbonus||0)+(t.totalservicebonus||0)||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s(t.totalservicebonus||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s(t.totalgoodsbonus||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s(t.totalpaidbonus||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s(t.totalunpaidbonus||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s(t.estimatedworkhours||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s(t.total_time||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                    "+e._s((100*(t.meanworkload||0)).toFixed(2).toString()+"%")+"\n                  ")])],1)])}))])])]):e._e(),e._v(" "),e.loadingError||e.isLoading||!e.byOffices||!e.byOffices.length||e.byOffices.warning?e._e():s("div",[s("h2",[e._v("По отделениям")]),e._v(" "),e._l(e.byOffices,function(t){return e.isLoading?e._e():s("div",{key:t.id},[s("h3",[e._v(e._s(e.$store.getters.getOfficeName(t.officeId)))]),e._v(" "),s("div",{staticClass:"grid-x grid-margin-x grid-margin-y margin-bottom-10px"},[s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.uniqueEmployeesCount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(t.uniqueEmployeesCount,"Сотрудник","Сотрудника","Сотрудников")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalsalary||0))]),e._v(" "),s("label",[e._v("Начисленная заплата, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalpaidsalary||0))]),e._v(" "),s("label",[e._v("Выплаченая зарплата, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalpenalty||0))]),e._v(" "),s("label",[e._v("Штрафы, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalunpaidsalary||0))]),e._v(" "),s("label",[e._v("Невыплаченая зарплата, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s((t.totalgoodsbonus||0)+(t.totalservicebonus||0)||0))]),e._v(" "),s("label",[e._v("Начисленная премия, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalservicebonus||0))]),e._v(" "),s("label",[e._v("Премия (услуги), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalgoodsbonus||0))]),e._v(" "),s("label",[e._v("Премия (товары), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalpaidbonus||0))]),e._v(" "),s("label",[e._v("Выплаченная премия, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalunpaidbonus||0))]),e._v(" "),s("label",[e._v("Невыплаченная премия, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.estimatedworkhours||0))]),e._v(" "),s("label",[e._v("Рабочие часы в месяце")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.total_time||0))]),e._v(" "),s("label",[e._v("Отработанные часы")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s((100*(t.meanworkload||0)).toFixed(2).toString()+"%"))]),e._v(" "),s("label",[e._v("% отработанных часов")])])]),e._v(" "),s("div",[s("button",{staticClass:"button secondary small",on:{click:function(s){e.showOfficeDetails(t)}}},[e._v("\n              "+e._s(t.detailsShown?"Скрыть":"Показать детализацию по сотрудникам отделения")+"\n            ")])]),e._v(" "),t.detailsShown?s("div",{staticClass:"table-container margin-bottom-30px"},[s("table",{staticClass:"hover"},[e._m(1,!0),e._v(" "),s("tbody",e._l(t.employees,function(t){return s("tr",{key:t.employeeId},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s(t.name||"Неизвестно")+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s(t.totalsalary||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s(t.totalpenalty||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s(t.totalpaidsalary||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s(t.totalunpaidsalary||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s((t.totalgoodsbonus||0)+(t.totalservicebonus||0)||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s(t.totalservicebonus||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s(t.totalgoodsbonus||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s(t.totalpaidbonus||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s(t.totalunpaidbonus||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s(t.estimatedworkhours||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s(t.total_time||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditEmployee/+parseInt(t.employeeId)}},[e._v("\n                      "+e._s((100*(t.meanworkload||0)).toFixed(2).toString()+"%")+"\n                    ")])],1)])}))])]):e._e()])})],2)],1)])],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"sticky-header"},[e._v("Сотрудник")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Начисленная заплата")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Штрафы")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Выплаченая зарплата")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Невыплаченая зарплата")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Начисленная премия")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Премия (услуги)")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Премия (товары)")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Выплаченная премия")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Невыплаченная премия")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Рабочие часы в месяце")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Отработанные часы")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("% отработанных часов")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"sticky-header"},[e._v("Сотрудник")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Начисленная заплата")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Штрафы")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Выплаченая зарплата")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Невыплаченая зарплата")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Начисленная премия")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Премия (услуги)")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Премия (товары)")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Выплаченная премия")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Невыплаченная премия")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Рабочие часы в месяце")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Отработанные часы")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("% отработанных часов")])])])}]};var qe=s("VU/8")(Ue,Be,!1,function(e){s("hcnh")},null,null).exports,ze={name:"ClientsReport",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},mounted:function(){document.title=this.$route.meta.title,this.load()},data:function(){return{period:this.moment().format("MM YYYY"),clientIds:[],officeIds:[],isLoading:!1,loadingError:"",summary:null,byOffices:[],byClients:[],byOfficesAndClients:[]}},methods:{load:function(){var e=this;this.isLoading=!0,this.loadingError="";var t={period:this.moment(this.period,"MM YYYY").format("DD.MM.YYYY")};this.clientIds&&this.clientIds.length>0&&(t.clientIds=this.clientIds),this.officeIds&&this.officeIds.length>0&&(t.officeIds=this.officeIds),y.post("GenerateClientReport/",t).then(function(t){if(e.summary=t.data.summary[0],!t.data.byOfficeAndClient.warning)for(var s in t.data.byOffices){var n=t.data.byOffices[s];n.clients=t.data.byOfficeAndClient.filter(function(e){return e.officeId===n.officeId}),n.detailsShown=!1,n.uniqueClientsCount=new Ve.a(n.clients.map(function(e){return e.clientId})).size}e.byOffices=t.data.byOffices,e.byClients=t.data.byClients,e.byOfficesAndClients=t.data.byOfficeAndClient,e.isLoading=!1}).catch(function(t){e.loadingError=t,e.summary=null,e.byOffices=[],e.byClients=[],e.byOfficesAndClients=[],e.isLoading=!1})},inclineWord:function(e,t,s,n){if(e){var i=e.toString()[e.toString().length-1];if(["5","6","7","8","9","0"].includes(i)||e%100>10&&e%100<20)return n;if(["2","3","4"].includes(i))return s;if("1"===i)return t}return t},showOfficeDetails:function(e){e.detailsShown=!e.detailsShown},getLoyalityDescription:function(e){switch(e){case"lost":return'<span title="Не посещал 3 месяца">Потерян</span>';case"likely lost":return'<span title="Не посещал более 40 дней">Вероятно потерян</span>';case"loyal":return'<span title="Более 2 посещений за 3 месяца, последнее не более 40 дней назад">Лоялен</span>';case"likely loyal":return'<span title="Более 1 посещения за 3 месяца, последнее не более 40 дней назад">Вероятно лоялен</span>';case"ambivalent":return"Пока не ясно"}return e}},computed:{offices:{get:function(){return this.$store.state.offices}},clients:{get:function(){return this.$store.state.clients}},periods:function(){for(var e=[],t=0;t<=12;t++)e.push(this.moment().subtract(t,"months").format("MM YYYY"));return e},uniqueClientsCount:function(){if(this.byClients&&this.byClients.length&&!this.byClients.warning&&!this.byClients.error)return new Ve.a(this.byClients.map(function(e){return e.clientId})).size}}},We={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"reports"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("Отчёт по клиентам")]),e._v(" "),s("div",{staticClass:"grid-x grid-padding-x no-padding-small"},[s("div",{staticClass:"cell large-4 small-12"},[s("label",[e._v("Месяц")]),e._v(" "),s("v-select",{attrs:{clearable:!1,value:e.period,label:"name",options:e.periods},model:{value:e.period,callback:function(t){e.period=t},expression:"period"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell large-4 small-12"},[s("label",[e._v("Отделения")]),e._v(" "),s("v-select",{attrs:{multiple:"",reduce:function(e){return e.id},value:e.officeIds,label:"name",options:e.offices},model:{value:e.officeIds,callback:function(t){e.officeIds=t},expression:"officeIds"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell large-4 small-12"},[s("label",[e._v("Клиенты")]),e._v(" "),s("v-select",{attrs:{multiple:"",reduce:function(e){return e.id},value:e.clientIds,"get-option-label":e.$store.getters.getClientDescription,options:e.clients},model:{value:e.clientIds,callback:function(t){e.clientIds=t},expression:"clientIds"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell small-12"},[s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.load}},[e._v("Показать")])])]),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),!e.loadingError&&!e.isLoading&&e.summary&&(!e.summary.totalvisitsduringperiod||e.byOffices.length&&e.byOffices.warning)?s("div",[e._v("Нет данных по выбранным фильтрам")]):e._e(),e._v(" "),!e.loadingError&&!e.isLoading&&e.summary&&e.summary.totalvisitsduringperiod?s("div",[s("h2",[e._v("Итого")]),e._v(" "),s("div",{staticClass:"grid-x grid-margin-x grid-margin-y margin-bottom-10px"},[s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.uniqueClientsCount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(e.uniqueClientsCount,"Клиент","Клиента","Клиентов")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalvisitsduringperiod||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(e.summary.totalvisitsduringperiod,"Посещение","Посещения","Посещений")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalsum||0))]),e._v(" "),s("label",[e._v("Выручка, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalservicesum||0))]),e._v(" "),s("label",[e._v("Выручка от услуг, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalgoodssum||0))]),e._v(" "),s("label",[e._v("Выручка от продажи товаров, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalcash||0))]),e._v(" "),s("label",[e._v("Наличка, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalcashless||0))]),e._v(" "),s("label",[e._v("Безнал, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totaldiscount||0))]),e._v(" "),s("label",[e._v("Скидки, ₽")])])]),e._v(" "),s("div",{staticClass:"table-container margin-bottom-30px"},[s("table",{staticClass:"hover"},[e._m(0),e._v(" "),s("tbody",e._l(e.byClients,function(t){return s("tr",{key:t.clientId},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                    "+e._s(t.name||"Неизвестно")+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                    "+e._s(t.totalsum||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                    "+e._s(t.totalservicesum||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                    "+e._s(t.totalgoodssum||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                    "+e._s(t.totalcash||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                    "+e._s(t.totalcashless||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                    "+e._s(t.totaldiscount||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                    "+e._s(t.totalvisitsduringperiod)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},e._l(t.mastervisits,function(t){return s("div",{key:t},[s("div",[s("router-link",{attrs:{to:"/EditEmployee/"+t.masterId.toString()}},[e._v(e._s(t.name))])],1),e._v(" "),s("div",{staticClass:"margin-bottom-10px"},[e._v(e._s(t.dailyvisitscount||0)+" "+e._s(e.inclineWord(t.dailyvisitscount,"раз","раза","раз")))])])}))],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                    "+e._s(t.totalvisits)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                    "+e._s(t.lastndaysvisitscount||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                    "+e._s(t.lastvisitdatetime||0)+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                    "+e._s(t.newclient?"Да":"Нет")+"\n                  ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)},domProps:{innerHTML:e._s(e.getLoyalityDescription(t.loyalty))}})],1)])}))])])]):e._e(),e._v(" "),e.loadingError||e.isLoading||!e.byOffices||!e.byOffices.length||e.byOffices.warning?e._e():s("div",[s("h2",[e._v("По отделениям")]),e._v(" "),e._l(e.byOffices,function(t){return e.isLoading?e._e():s("div",{key:t.id},[s("h3",[e._v(e._s(e.$store.getters.getOfficeName(t.officeId)))]),e._v(" "),s("div",{staticClass:"grid-x grid-margin-x grid-margin-y margin-bottom-10px"},[s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.uniqueClientsCount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(t.uniqueClientsCount,"Клиент","Клиента","Клиентов")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalvisitsduringperiod||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(t.totalvisitsduringperiod,"Посещение","Посещения","Посещений")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalsum||0))]),e._v(" "),s("label",[e._v("Выручка, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalservicesum||0))]),e._v(" "),s("label",[e._v("Выручка от услуг, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalgoodssum||0))]),e._v(" "),s("label",[e._v("Выручка от продажи товаров, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalcash||0))]),e._v(" "),s("label",[e._v("Наличка, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalcashless||0))]),e._v(" "),s("label",[e._v("Безнал, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-auto"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totaldiscount||0))]),e._v(" "),s("label",[e._v("Скидки, ₽")])])]),e._v(" "),s("div",[s("button",{staticClass:"button secondary small",on:{click:function(s){e.showOfficeDetails(t)}}},[e._v("\n              "+e._s(t.detailsShown?"Скрыть":"Показать детализацию по клиентам отделения")+"\n            ")])]),e._v(" "),t.detailsShown?s("div",{staticClass:"table-container margin-bottom-30px"},[s("table",{staticClass:"hover"},[e._m(1,!0),e._v(" "),s("tbody",e._l(t.clients,function(t){return s("tr",{key:t.clientId},[s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                      "+e._s(t.name||"Неизвестно")+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                      "+e._s(t.totalsum||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                      "+e._s(t.totalservicesum||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                      "+e._s(t.totalgoodssum||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                      "+e._s(t.totalcash||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                      "+e._s(t.totalcashless||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                      "+e._s(t.totaldiscount||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                      "+e._s(t.totalvisitsduringperiod)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},e._l(t.mastervisits,function(t){return s("div",{key:t},[s("div",[s("router-link",{attrs:{to:"/EditEmployee/"+t.masterId.toString()}},[e._v(e._s(t.name))])],1),e._v(" "),s("div",{staticClass:"margin-bottom-10px"},[e._v(e._s(t.dailyvisitscount||0)+" "+e._s(e.inclineWord(t.dailyvisitscount,"раз","раза","раз")))])])}))],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                      "+e._s(t.totalvisits)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                      "+e._s(t.lastndaysvisitscount||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                      "+e._s(t.lastvisitdatetime||0)+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)}},[e._v("\n                      "+e._s(t.newclient?"Да":"Нет")+"\n                    ")])],1),e._v(" "),s("td",[s("router-link",{staticClass:"table-link",attrs:{to:/EditClient/+parseInt(t.clientId)},domProps:{innerHTML:e._s(e.getLoyalityDescription(t.loyalty))}})],1)])}))])]):e._e()])})],2)],1)])],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"sticky-header"},[e._v("Клиент")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Выручка")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Выручка от услуг")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Выручка от продажи товаров")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Наличка")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Безнал")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Скидки")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Посещения за выбранный период")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Посещения мастеров за всё время")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Посещения всего")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Посещения за последние 6 мес.")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Предыдущее посещение")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Новый клиент")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Лояльность")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"sticky-header"},[e._v("Клиент")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Выручка")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Выручка от услуг")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Выручка от продажи товаров")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Наличка")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Безнал")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Скидки")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Посещения за выбранный период")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Посещения мастеров за всё время")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Посещения всего")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Посещения за последние 6 мес.")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Предыдущее посещение")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Новый клиент")]),e._v(" "),s("th",{staticClass:"sticky-header"},[e._v("Лояльность")])])])}]};var Ze=s("VU/8")(ze,We,!1,function(e){s("VOKn")},null,null).exports,Xe={name:"FinancialReport",components:{appMenu:f,VueElementLoading:a.a,"v-select":h.a},mounted:function(){document.title=this.$route.meta.title,this.load()},data:function(){return{period:this.moment().format("MM YYYY"),officeIds:[],isLoading:!1,loadingError:"",summary:null,byOffices:[]}},methods:{load:function(){var e=this;this.isLoading=!0,this.loadingError="";var t={period:this.moment(this.period,"MM YYYY").format("DD.MM.YYYY")};this.officeIds&&this.officeIds.length>0&&(t.officeIds=this.officeIds),y.post("GenerateFinanceReport/",t).then(function(t){e.summary=t.data.summary[0],e.byOffices=t.data.byOffices,e.isLoading=!1}).catch(function(t){e.loadingError=t,e.summary=null,e.byOffices=[],e.isLoading=!1})},inclineWord:function(e,t,s,n){if(e){var i=e.toString()[e.toString().length-1];if(["5","6","7","8","9","0"].includes(i)||e%100>10&&e%100<20)return n;if(["2","3","4"].includes(i))return s;if("1"===i)return t}return t}},computed:{offices:{get:function(){return this.$store.state.offices}},periods:function(){for(var e=[],t=0;t<=12;t++)e.push(this.moment().subtract(t,"months").format("MM YYYY"));return e}}},Ke={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("appMenu",{attrs:{"selected-element":"reports"}}),e._v(" "),s("div",{staticClass:"content"},[s("h1",[e._v("Финансовый отчёт")]),e._v(" "),s("div",{staticClass:"grid-x grid-padding-x no-padding-small"},[s("div",{staticClass:"cell large-6 small-12"},[s("label",[e._v("Месяц")]),e._v(" "),s("v-select",{attrs:{clearable:!1,value:e.period,label:"name",options:e.periods},model:{value:e.period,callback:function(t){e.period=t},expression:"period"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell large-6 small-12"},[s("label",[e._v("Отделения")]),e._v(" "),s("v-select",{attrs:{multiple:"",reduce:function(e){return e.id},value:e.officeIds,label:"name",options:e.offices},model:{value:e.officeIds,callback:function(t){e.officeIds=t},expression:"officeIds"}},[s("div",{attrs:{slot:"no-options"},slot:"no-options"},[e._v("Ничего не найдено")])])],1),e._v(" "),s("div",{staticClass:"cell small-12"},[s("button",{staticClass:"button primary",attrs:{type:"button"},on:{click:e.load}},[e._v("Показать")])])]),e._v(" "),s("div",[s("vue-element-loading",{attrs:{active:e.isLoading,color:"#1C457D"}}),e._v(" "),e.loadingError?s("div",{staticClass:"callout alert"},[s("h5",[e._v("Произошла ошибка при загрузке данных")]),e._v(" "),s("p",[e._v(e._s(e.loadingError))])]):e._e(),e._v(" "),!e.loadingError&&!e.isLoading&&e.summary&&(!e.summary.operationcount||e.byOffices.length&&e.byOffices.warning)?s("div",[e._v("Нет данных по выбранным фильтрам")]):e._e(),e._v(" "),!e.loadingError&&!e.isLoading&&e.summary&&e.summary.operationcount?s("div",[s("h2",[e._v("Итого")]),e._v(" "),s("div",{staticClass:"grid-x grid-margin-x grid-margin-y margin-bottom-10px"},[s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalincome.toFixed(2)||0))]),e._v(" "),s("label",[e._v("Выручка, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.serviceincome||0))]),e._v(" "),s("label",[e._v("Выручка (услуги), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.goodsincome||0))]),e._v(" "),s("label",[e._v("Выручка (товары), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalcash||0))]),e._v(" "),s("label",[e._v("Выручка (наличка), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalcashless||0))]),e._v(" "),s("label",[e._v("Выручка (безнал), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalspend.toFixed(2)||0))]),e._v(" "),s("label",[e._v("Расходы, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.totalprofit.toFixed(2)||0))]),e._v(" "),s("label",[e._v("Прибыль, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.operationcount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(e.summary.operationcount,"Операция","Операции","Операций")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.serviceoperationcount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(e.summary.operationcount,"Услуга оказана","Услуги оказано","Услуг оказано")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.goodsoperationcount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(e.summary.operationcount,"Товар продан","Товара продано","Товаров продано")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(e.summary.spendoperationcount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(e.summary.operationcount,"Расход внесен","Расхода внесено","Расходов внесено")))])])])]):e._e(),e._v(" "),e.loadingError||e.isLoading||!e.byOffices||!e.byOffices.length||e.byOffices.warning?e._e():s("div",[s("h2",[e._v("По отделениям")]),e._v(" "),e._l(e.byOffices,function(t){return e.isLoading?e._e():s("div",{key:t.id},[s("h3",[e._v(e._s(e.$store.getters.getOfficeName(t.officeId)))]),e._v(" "),s("div",{staticClass:"grid-x grid-margin-x grid-margin-y margin-bottom-10px"},[s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalincome.toFixed(2)||0))]),e._v(" "),s("label",[e._v("Выручка, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.serviceincome||0))]),e._v(" "),s("label",[e._v("Выручка (услуги), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.goodsincome||0))]),e._v(" "),s("label",[e._v("Выручка (товары), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalcash||0))]),e._v(" "),s("label",[e._v("Выручка (наличка), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalcashless||0))]),e._v(" "),s("label",[e._v("Выручка (безнал), ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalspend.toFixed(0)||0))]),e._v(" "),s("label",[e._v("Расходы, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.totalprofit.toFixed(2)||0))]),e._v(" "),s("label",[e._v("Прибыль, ₽")])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.operationcount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(t.operationcount,"Операция","Операции","Операций")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.serviceoperationcount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(t.operationcount,"Услуга оказана","Услуги оказано","Услуг оказано")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.goodsoperationcount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(t.operationcount,"Товар продан","Товара продано","Товаров продано")))])]),e._v(" "),s("div",{staticClass:"cell small-6 medium-4 large-2"},[s("div",{staticClass:"big-number"},[e._v(e._s(t.spendoperationcount||0))]),e._v(" "),s("label",[e._v(e._s(e.inclineWord(t.operationcount,"Расход внесен","Расхода внесено","Расходов внесено")))])])])])})],2)],1)])],1)},staticRenderFns:[]};var Je=s("VU/8")(Xe,Ke,!1,function(e){s("WGhR")},null,null).exports,Qe={name:"NotFound",components:{appMenu:f},mounted:function(){document.title=this.$route.meta.title},data:function(){return{}},methods:{},computed:{}},et={render:function(){var e=this.$createElement,t=this._self._c||e;return t("main",[t("appMenu"),this._v(" "),this._m(0)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"content"},[t("h1",[this._v("Страница не найдена")]),this._v(" "),t("p",[t("a",{attrs:{href:"/"}},[this._v("На главную")])])])}]};var tt=s("VU/8")(Qe,et,!1,function(e){s("lbBR")},null,null).exports;n.a.use(c.a);var st=new c.a({routes:[{path:"/",name:"Session",component:k,meta:{title:"Смена"}},{path:"/EditSession/:id?",name:"EditSession",component:x,meta:{title:"Смена"}},{path:"/SessionsHistory",name:"SessionsHistory",component:P,meta:{title:"История смен и операций"}},{path:"/EditService/:id?",name:"EditService",component:j,meta:{title:"Услуга"}},{path:"/EditGoodsSell/:id?",name:"EditGoodsSell",component:F,meta:{title:"Продажа товаров"}},{path:"/EditEmployeePayment/:id?",name:"EditEmployeePayment",component:A,meta:{title:"Выплата сотруднику"}},{path:"/EditExpense/:id?",name:"EditExpense",component:U,meta:{title:"Расход"}},{path:"/EditClient/:id?",name:"EditClient",component:z,meta:{title:"Клиент"}},{path:"/Clients",name:"Clients",component:X,meta:{title:"Клиенты"}},{path:"/UploadExpenses",name:"UploadExpenses",component:Q,meta:{title:"Внести расходы"}},{path:"/Offices",name:"Offices",component:se,meta:{title:"Отделения"}},{path:"/EditOffice/:id?",name:"EditOffice",component:ae,meta:{title:"Отделение"}},{path:"/ServiceTypes",name:"ServiceTypes",component:le,meta:{title:"Услуги"}},{path:"/EditServiceType/:id?",name:"EditServiceType",component:de,meta:{title:"Тип услуги"}},{path:"/GoodsTypes",name:"GoodsTypes",component:pe,meta:{title:"Товары"}},{path:"/EditGoodsType/:id?",name:"EditGoodsType",component:ye,meta:{title:"Товар"}},{path:"/ExpenseTypes",name:"ExpenseTypes",component:be,meta:{title:"Типы расходов"}},{path:"/EditExpenseType/:id?",name:"EditExpenseType",component:Se,meta:{title:"Тип расхода"}},{path:"/EmployeePaymentTypes",name:"EmployeePaymentTypes",component:Te,meta:{title:"Типы выплат сотруднику"}},{path:"/EditEmployeePaymentType/:id?",name:"EditEmployeePaymentType",component:Le,meta:{title:"Тип выплаты сотруднику"}},{path:"/Employees",name:"Employees",component:Me,meta:{title:"Сотрудники"}},{path:"/EditEmployee/:id?",name:"EditEmployee",component:je,meta:{title:"Сотрудник"}},{path:"/MasterTypes",name:"MasterTypes",component:Fe,meta:{title:"Категории мастеров"}},{path:"/EditMasterType/:id?",name:"EditMasterType",component:Ae,meta:{title:"Категория мастера"}},{path:"/EmployeesReport",name:"EmployeesReport",component:qe,meta:{title:"Отчёт по сотрудникам"}},{path:"/ClientsReport",name:"ClientsReport",component:Ze,meta:{title:"Отчёт по клиентам"}},{path:"/FinancialReport",name:"FinancialReport",component:Je,meta:{title:"Финансовый отчёт"}},{path:"*",component:tt,meta:{title:"Страница не найдена"}}],scrollBehavior:function(e,t,s){return s||{x:0,y:0}}}),nt=s("gRE1"),it=s.n(nt),at=s("Dd8w"),ot=s.n(at),rt=s("NYxO"),lt=s("PJh5"),ct=s.n(lt);n.a.use(rt.a),n.a.config.devtools=!0;var ut=new rt.a.Store({state:{isStateLoading:!1,isStateLoaded:!1,stateLoadDetails:{serviceTypes:!1,goodsTypes:!1,employeePaymentTypes:!1,spendTypes:!1,offices:!1,employees:!1,clients:!1,masterCategories:!1},stateGetError:"",currentOfficeId:null,currentSessionGetError:"",isCurrentSessionLoading:!1,currentSession:{},refreshCurrentSession:null,operationTypes:[{id:"serviceoperation",name:"Услуга"},{id:"goodsoperation",name:"Продажа товара"},{id:"spendoperation",name:"Расход"},{id:"employeepayment",name:"Выплата сотруднику"}],officeStates:[{id:"open",name:"Работает"},{id:"closed",name:"Не работает"}],serviceStates:[{id:"active",name:"Используется"},{id:"notactive",name:"Не используется"}],goodsStates:[{id:"active",name:"В продаже"},{id:"notactive",name:"Не продается"}],spendTypeStates:[{id:"active",name:"Используется"},{id:"notactive",name:"Не используется"}],employeePaymentTypeStates:[{id:"active",name:"Используется"},{id:"notactive",name:"Не используется"}],masterCategoryStates:[{id:"active",name:"Используется"},{id:"notactive",name:"Не используется"}],employeeStates:[{id:"working",name:"Работает"},{id:"notworking",name:"Не работает"}],userRoles:[{id:"officeAdmin",name:"Администратор офиса"},{id:"manager",name:"Управляющий"},{id:"master",name:"Мастер"},{id:"other",name:"Сотрудник"}],contactTypes:[{id:"phone",name:"Телефон"},{id:"whatsapp",name:"WhatsApp"},{id:"telegram",name:"Telegram"},{id:"viber",name:"Viber"},{id:"email",name:"Почта"},{id:"instagram",name:"Instagram"},{id:"vk",name:"ВКонтакте"},{id:"facebook",name:"Facebook"},{id:"other",name:"Другое"}],employeePaymentTypeTypes:[{id:"salary",name:"Зарплата"},{id:"bonus",name:"Премия"},{id:"penalty",name:"Штраф"}],serviceTypes:[],goodsTypes:[],employeePaymentTypes:[],spendTypes:[],offices:[],employees:[],clients:[],masterCategories:[]},getters:{getServiceName:function(e){return function(t){var s=e.serviceTypes.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getEmployeeName:function(e){return function(t){var s=e.employees.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getItemName:function(e){return function(t){var s=e.goodsTypes.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getContactTypeName:function(e){return function(t){var s=e.contactTypes.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getSpendTypeName:function(e){return function(t){var s=e.spendTypes.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getEmployeePaymentTypeName:function(e){return function(t){var s=e.employeePaymentTypes.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getMasterCategoryName:function(e){return function(t){var s=e.masterCategories.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getClientDescription:function(e){return function(t){var s=t;if("number"==typeof s&&(s=e.clients.filter(function(e){return e.id===s})[0]),s){if(null===s.id)return"Новый клиент";var n=s.contacts.filter(function(e){return"phone"===e.type})[0];return n?s.name+" ("+n.value+")":s.name+" (телефон не указан)"}return"–"}},getDateTimeFromOperation:function(e){return function(e){var t="";return e.finishDatetime?t=e.finishDatetime:e.datetime&&(t=e.datetime),ct.a.utc(t).local().format("DD.MM.YYYY HH:mm")}},getTimeFromOperation:function(e){return function(e){var t="";return e.startDatetime?t=e.startDatetime:e.datetime&&(t=e.datetime),ct.a.utc(t).local().format("HH:mm")}},getEmployeeNameFromOperation:function(e,t){return function(e){return e.employeeId?t.getEmployeeName(e.employeeId):e.masterId?t.getEmployeeName(e.masterId):e.adminId?t.getEmployeeName(e.adminId):"–"}},getOperationContent:function(e,t){return function(e){return"serviceoperation"===e.type?t.getServiceName(e.serviceId):"goodsoperation"===e.type?t.getItemName(e.goodsId):"spendoperation"===e.type?t.getSpendTypeName(e.expenseTypeId):"employeepayment"===e.type?t.getEmployeePaymentTypeName(e.employeePaymentTypeId):"–"}},getOperationSum:function(e){return function(e){return"serviceoperation"===e.type?e.cashSum+e.cashlessSum-e.discountSum:"goodsoperation"===e.type?e.cashSum+e.cashlessSum-e.discountSum:"spendoperation"===e.type?e.sum:"employeepayment"===e.type?e.sum:"–"}},getOperationBonus:function(e){return function(e){return"serviceoperation"===e.type?e.masterBonusSum+e.adminBonusSum:"goodsoperation"===e.type?e.employeeBonusSum+e.adminBonusSum:"–"}},getOperationLink:function(e){return function(e){return"serviceoperation"===e.type?"/EditService/"+e.id.toString():"goodsoperation"===e.type?"/EditGoodsSell/"+e.id.toString():"spendoperation"===e.type?"/EditExpense/"+e.id.toString():"employeepayment"===e.type?"/EditEmployeePayment/"+e.id.toString():void 0}},getOfficeName:function(e){return function(t){var s=e.offices.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getOfficeStateName:function(e){return function(t){var s=e.officeStates.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getServiceStateName:function(e){return function(t){var s=e.serviceStates.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getGoodsStateName:function(e){return function(t){var s=e.goodsStates.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getSpendTypeStateName:function(e){return function(t){var s=e.spendTypeStates.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getEmployeePaymentStateName:function(e){return function(t){var s=e.employeePaymentTypeStates.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getMasterCategoryStateName:function(e){return function(t){var s=e.masterCategoryStates.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getEmployeeStateName:function(e){return function(t){var s=e.employeeStates.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getUserRoleName:function(e){return function(t){var s=e.userRoles.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getEmployeePaymentTypeTypeName:function(e){return function(t){var s=e.employeePaymentTypeTypes.filter(function(e){return e.id===t})[0];return s?s.name:"–"}},getUserPicturePlaceholderText:function(e){return function(e){var t="";return e.split(" ").map(function(e){t+=e[0].toUpperCase()}),t}}},mutations:{updateStore:function(e,t){e[t.name]=t.value},updateStateLoadingDetails:function(e,t){e.stateLoadDetails[t.name]=t.value},updateIfExists:function(e,t){var s=t.data,n=t.key;s[n]&&(e[n]=s[n])}},actions:{getCurrentSession:function(e){e.state.currentOfficeId&&(e.commit("updateStore",{name:"isCurrentSessionLoading",value:!0}),y.post("GetCurrentSession/",{officeId:e.state.currentOfficeId,withOperations:!0}).then(function(t){var s=t.data;s.employees&&s.employees.length&&(s.employees=s.employees.map(function(t){var s=e.state.employees.filter(function(e){return e.id===t.id})[0];return ot()({},t,s)})),e.commit("updateStore",{name:"currentSession",value:s}),e.commit("updateStore",{name:"isCurrentSessionLoading",value:!1})}).catch(function(t){e.commit("updateStore",{name:"currentSessionGetError",value:t}),e.commit("updateStore",{name:"isCurrentSessionLoading",value:!1})}))},checkIfStateLoaded:function(e){var t=it()(e.state.stateLoadDetails).every(function(e){return e});t!==e.state.isStateLoaded&&(e.commit("updateStore",{name:"isStateLoaded",value:t}),e.commit("updateStore",{name:"isStateLoading",value:!t}))},getState:function(e,t){e.state.isStateLoaded||(e.commit("updateStore",{name:"isStateLoading",value:!0}),e.commit("updateStore",{name:"isStateLoaded",value:!1})),y.post("GetServicesPrices/",{}).then(function(t){var s=t.data;e.commit("updateStore",{name:"serviceTypes",value:s}),e.commit("updateStateLoadingDetails",{name:"serviceTypes",value:!0}),e.dispatch("checkIfStateLoaded")}).catch(function(t){e.commit("updateStore",{name:"stateGetError",value:t})}),y.post("GetGoods/",{}).then(function(t){var s=t.data;e.commit("updateStore",{name:"goodsTypes",value:s}),e.commit("updateStateLoadingDetails",{name:"goodsTypes",value:!0}),e.dispatch("checkIfStateLoaded")}).catch(function(t){e.commit("updateStore",{name:"stateGetError",value:t})}),y.post("GetEmployeePaymentTypes/",{}).then(function(t){var s=t.data;e.commit("updateStore",{name:"employeePaymentTypes",value:s}),e.commit("updateStateLoadingDetails",{name:"employeePaymentTypes",value:!0}),e.dispatch("checkIfStateLoaded")}).catch(function(t){e.commit("updateStore",{name:"stateGetError",value:t})}),y.post("GetSpendTypes/",{}).then(function(t){var s=t.data;e.commit("updateStore",{name:"spendTypes",value:s}),e.commit("updateStateLoadingDetails",{name:"spendTypes",value:!0}),e.dispatch("checkIfStateLoaded")}).catch(function(t){e.commit("updateStore",{name:"stateGetError",value:t})}),y.post("GetOffices/",{}).then(function(t){var s=t.data;e.commit("updateStore",{name:"offices",value:s}),e.commit("updateStateLoadingDetails",{name:"offices",value:!0}),e.dispatch("checkIfStateLoaded")}).catch(function(t){e.commit("updateStore",{name:"stateGetError",value:t})}),y.post("GetEmployees/",{}).then(function(t){var s=t.data;e.commit("updateStore",{name:"employees",value:s}),e.commit("updateStateLoadingDetails",{name:"employees",value:!0}),e.dispatch("checkIfStateLoaded")}).catch(function(t){e.commit("updateStore",{name:"stateGetError",value:t})}),y.post("GetClients/",{q:""}).then(function(t){var s=t.data;e.commit("updateStore",{name:"clients",value:s}),e.commit("updateStateLoadingDetails",{name:"clients",value:!0}),e.dispatch("checkIfStateLoaded")}).catch(function(t){e.commit("updateStore",{name:"stateGetError",value:t})}),y.post("GetBarberCategories/",{}).then(function(t){var s=t.data;e.commit("updateStore",{name:"masterCategories",value:s}),e.commit("updateStateLoadingDetails",{name:"masterCategories",value:!0}),e.dispatch("checkIfStateLoaded")}).catch(function(t){e.commit("updateStore",{name:"stateGetError",value:t})})}}});n.a.prototype.moment=ct.a,n.a.config.productionTip=!1,new n.a({store:ut,el:"#app",router:st,components:{App:l},template:"<App/>"})},Nk2v:function(e,t){},TBX2:function(e,t){},U4yb:function(e,t){},VOKn:function(e,t){},WGhR:function(e,t){},ayN0:function(e,t){},dPSK:function(e,t){},ecyf:function(e,t){},gTcm:function(e,t){},hcnh:function(e,t){},jSIZ:function(e,t){},jve6:function(e,t){},kxPN:function(e,t){},lbBR:function(e,t){},mpjx:function(e,t){},musY:function(e,t){},oaog:function(e,t){},uslO:function(e,t,s){var n={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-SG":"oYA3","./en-SG.js":"oYA3","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-il":"QZk1","./en-il.js":"QZk1","./en-nz":"dyB6","./en-nz.js":"dyB6","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./ga":"U5Iz","./ga.js":"U5Iz","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it-ch":"/E8D","./it-ch.js":"/E8D","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ku":"kI9l","./ku.js":"kI9l","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mn":"CqHt","./mn.js":"CqHt","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./tg":"5SNd","./tg.js":"5SNd","./th":"XzD+","./th.js":"XzD+","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./ug-cn":"To0v","./ug-cn.js":"To0v","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function i(e){return s(a(e))}function a(e){var t=n[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}i.keys=function(){return Object.keys(n)},i.resolve=a,e.exports=i,i.id="uslO"},yID9:function(e,t){},zikU:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.9c62233a9fe76499f669.js.map